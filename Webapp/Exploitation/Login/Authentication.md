---
id: Authentication
aliases: []
tags:
  - Webapp/Exploitation/Server-Side/Authentication
---

# Authentication

**Authentication Vulnerabilities** can allow attackers
to gain access to sensitive data and functionality.

___

<!-- Brute Force Attacks {{{-->
## Brute Force Attacks

<!-- Brute Forcing Usernames {{{-->
### Brute Forcing Usernames

Usernames may be easy to guess if they conform to a recognizable pattern
(*e.g., e-mail address*)

High-privileged users usually have predictable usernames
(*e.g., `admin`, `administrator`*)

The website and HTTP responses may expose valuable information.

<!-- Wordlists {{{-->
> [!tip]- Wordlists
>
> - [[SecLists#Usernames|SecLists]]
> - [[CeWL]] — Generate wordlist
<!-- }}} -->

[[Hydra]] — Try a list of usernames
until a different HTTP response is received

1. Capture HTTP POST form with test credentials

<!-- Example {{{-->
> [!example]-
>
> Test credentials: `admin:admin`
>
> ```
> POST / HTTP/1.1
> Host: 10.10.102.115
> User-Agent: Mozilla/5.0
>
> ...SNIP...
>
> username=admin&password=admin
> ```
<!-- }}} -->

2. Capture the HTTP Response

<!-- Example {{{-->
> [!example]-
>
> ```sh
> HTTP/1.1 202 Accepted
> Content-Type: text/plain
> Content-Length: 28
>
> ...SNIP...
>
> Invalid username and password
> ```
<!-- }}} -->

3. Run [[Hydra]]

```sh
hydra -L <usernames> -p <test_password> <target_url> http-post-form "/:username=^USER^&password=^PASS^:<http_response>"
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> hydra -L ~/Downloads/xato-net-10-million-usernames-dup.txt -p test 10.10.102.115 http-post-form "/:username=^USER^&password=^PASS^:Invalid username and password."
> ```
>
> > [!info]
> > - `-L`: Specify wordlist
> > - `-p test`: Specify test password
> > - `http-post-form`: Protocol to be used (*Include captured POST form*)
> > - `/:username=^USER^`: Insert usernames from the wordlist
> > - `&password=^PASS^`: Insert test password from `-p` parameter
> > - `Invalid username and password.`: Response received from the site
> >   for incorrect password
<!-- }}} -->

<!-- }}} -->

<!-- Brute Forcing Passwords {{{-->
### Brute Forcing Passwords

Passwords may be brute-forced if there is no brute-force protection,
with the difficulty varying based on the strength of the password

<!-- Wordlists {{{-->
> [!tip]- Wordlists
>
> - [[SecLists#Passwords|SecLists]]
> - [[CeWL]] — Generate wordlist
<!-- }}} -->

1. Capture HTTP POST form with test credentials

<!-- Example {{{-->
> [!example]-
>
> Test credentials: `admin:admin`
>
> ```
> POST / HTTP/1.1
> Host: 10.10.102.115
> User-Agent: Mozilla/5.0
>
> ...SNIP...
>
> username=admin&password=admin
> ```
<!-- }}} -->

2. Capture the HTTP Response

<!-- Example {{{-->
> [!example]-
>
> ```sh
> HTTP/1.1 202 Accepted
> Content-Type: text/plain
> Content-Length: 28
>
> ...SNIP...
>
> Invalid password
> ```
<!-- }}} -->

3. Run [[Hydra]]

```sh
hydra -l <username> -P <passwords.txt> <target_url> http-post-form "/:username=^USER^&password=^PASS^:<http_response>"
```

<!-- }}} -->

___
<!-- }}} -->

<!-- HTTP Authentication {{{-->
## HTTP Authentication

[Basic Authentication](https://en.wikipedia.org/wiki/Basic_access_authentication)
is a challenge-response protocol
where a web server demands user credentials
before granting access to protected resources

**Basic Authentication** is a HTTP user agent method
where the request contains an [Authorization header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Authorization)
field

[Authorization header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Authorization)
can be used to provide credentials
that authenticate a user agent with a server

```http
GET /protected_resource HTTP/1.1
Host: www.example.com
Authorization: Basic YWxpY2U6c2VjcmV0MTIz
```

<!-- Info {{{-->
> [!info]-
>
>  The username and password are
>  - Concatenated into a string
>  - Joined by a single colon (*`:`*)
>  - Encoded using [[Base64]]
>
> ```sh
> Authorization: Basic <user>:<password>
> ```
> ```sh
> Authorization: Basic YWxpY2U6c2VjcmV0MTIz
> ```
>
<!-- }}} -->

1. **User**: The user attempts to access a restricted area

2. **Server**: The server sends a [401 Unauthorized](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/401)
   status and a [WWW-Authenticate](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/WWW-Authenticate)
   header

3. **User**: The user is prompted to authenticate

4. **Browser**: The [Authorization header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Authorization)
   is sent

5. **Server**: The server decodes and verifies the credentials

___
<!-- }}} -->

<!-- Multi-Factor Authentication {{{-->
## Multi-Factor Authentication



___
<!-- }}} -->
