---
id: Exploitation
aliases: []
tags: []
---

# Exploitation

**Broken Access Control vulnerabilities** exist
when a user can access resources or perform actions
that they are not supposed to be able to

<!-- Vertical Privesc {{{-->
## Vertical Privesc

**Vertical Access Controls** restrict access to sensitive functionality
to specific types of users

<!-- Unprotected Functionality {{{-->
### Unprotected Functionality

Administrative functionality may be unprotected

```sh
https://insecure-website.com/admin
```

<!-- Info {{{-->
> [!info]-
>
> Vertical Privilege Escalation arises where an application
> does not enforce any protection for sensitive functionality
<!-- }}} -->

<!-- Tip {{{-->
> [!tip]-
>
> Administrative URLs may be disclosed in [[Metafiles]] or [[Well-Known]]
<!-- }}} -->

Administrative functionality may be concealed with a less-predictable URL
(*security by obscurity*)

```sh
https://insecure-website.com/administrator-panel-yb556
```

<!-- Tip {{{-->
> [!tip]-
>
> The application might still leak URL in its JavaScript code
>
> ```js
> <script>
>     var isAdmin = false;
>     if (isAdmin) {
>         ...
>         var adminPanelTag = document.createElement('a');
>         adminPanelTag.setAttribute('href', 'https://insecure-website.com/administrator-panel-yb556');
>         adminPanelTag.innerText = 'Admin panel';
>         ...
>     }
> </script>
> ```
<!-- }}} -->

<!-- }}} -->

<!-- Parameter-Based Access Control {{{-->
### Parameter-Based Access Control

Applications may store access role information
in a user-controllable location:

- A cookie
- A hidden field
- A preset query string parameter

```sh
https://insecure-website.com/login/home.jsp?admin=true
```

```sh
https://insecure-website.com/login/home.jsp?role=1
```

<!-- }}} -->

<!-- Platform Misconfiguration {{{-->
### Platform Misconfiguration

Applications may enforce access controls at the platform layer

```http
DENY: POST, /admin/deleteUser, managers
```

<!-- Info {{{-->
> [!info]-
>
> Denies access to the `POST` method on the URL `/admin/deleteUser`,
> for users in the `managers` group
<!-- }}} -->

<!-- Tip {{{-->
> [!tip]-
>
> Another HTTP Request method may have the same effect
>
> - `GET /admin/deleteUser`
> - `PUT /admin/deleteUser`
> - `DELETE /admin/deleteUser`
<!-- }}} -->

The application may allow the URL to be overridden via a request header

```http
POST / HTTP/1.1
X-Original-URL: /admin/deleteUser
...
```

<!-- Info {{{-->
> [!info]-
>
> Application frameworks may support non-standard HTTP Headers
> that can be used to override the URL in the original request
> (*e.g., `X-Original-URL`, `X-Rewrite-URL`*)
<!-- }}} -->

<!-- }}} -->

<!-- URL-Matching Discrepancies {{{-->
### URL-Matching Discrepancies

Web applications may tolerate inconsistent capitalization

```sh
/ADMIN/DELETEUSER
```

```sh
/admin/deleteUser
```

<!-- Info {{{-->
> [!info]-
>
> Access control mechanisms may treat these as two different endpoints
> and fail to enforce the correct restrictions
<!-- }}} -->

Append a trailing slash

```sh
/admin/deleteUser
```

```sh
/admin/deleteUser/
```

<!-- Info {{{-->
> [!info]-
>
> Access control mechanisms may treat these as two different endpoints
> and fail to enforce the correct restrictions
<!-- }}} -->


[Spring Framework](https://spring.io/projects/spring-framework)'s
allows an arbitrary file extension to be mapped
to the endpoint without extension

```sh
/admin/deleteUser.anything
```

<!-- Info {{{-->
> [!info]-
>
> The `useSuffixPatternMatch` option is enabled by default
> prior to Spring 5.3
<!-- }}} -->

<!-- }}} -->

___
<!-- }}} -->

<!-- Horizontal Access Controls {{{-->
## Horizontal Access Controls

**Horizontal Access Controls** restrict access to resources to specific users

Modify a parameter or cookie

```sh
https://insecure-website.com/myaccount?id=123
```

<!-- Info {{{-->
> [!info]-
>
> Horizontal privilege escalation attacks
> may use similar types of exploit methods to
> [[#Vertical Privesc|Vertical Privilege Escalation]]
>
<!-- }}} -->

<!-- Tip {{{-->
> [!tip]-
>
> Web applications may detect when the user is not permitted
> to access the resource, and redirects to the login page
>
> The response containing the redirect might include sensitive data
>
<!-- }}} -->

___
<!-- }}} -->
