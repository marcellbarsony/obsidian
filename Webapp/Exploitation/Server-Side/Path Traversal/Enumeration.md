---
id: Enumeration
aliases: []
tags:
  - Webapp/Exploitation/Server-Side/Path-Traversal/Enumeration
---


# Enumeration

Testing for directory traversal vulnerabilities

<!-- Info {{{-->
> [!info]- Resources
>
> - [PortSwigger Academy](https://portswigger.net/burp/documentation/desktop/testing-workflow/vulnerabilities/input-validation/directory-traversal)
> - [OWASP WSTG](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/01-Testing_Directory_Traversal_File_Include)
>
<!-- }}} -->

1. The web application loads an image using the following HTML

```html
<img src="/loadImage?filename=75.png">
```

<!-- Example {{{-->
> [!example]-
>
> Source code
>
> ![[source-code.png]]
>
<!-- }}} -->

2. The `loadImage` URL takes a `filename` parameter
   and returns the contents of the specified file

```sh
/var/www/images/75.png
```

___

<!-- Vulnerable Endpoints {{{-->
## Vulnerable Endpoints

A directory traversal vulnerability exists
when the server uses user-supplied input to load a file

This usually happens with

- Images (*e.g., avatar, product images, etc.*)
- Download buttons
- Anything that displays local files

<!-- Example {{{-->
> [!example]- Request Examples
>
> - `?file=`
> - `?image=`
> - `?filename=`
> - `?path=`
> - `/download/…`
> - `/productimage?…`
> - `/avatar?image=…`
> - `/getUserProfile.jsp?item=ikki.html`
> - `/index.php?file=content`
> - `/main.cgi?home=index.htm`
<!-- }}} -->

___
<!-- }}} -->

<!-- Burp Suite {{{-->
## Burp Suite

<!-- Warning {{{-->
> [!warning]
>
> [[Burp Suite]] Professional required
<!-- }}} -->

1. [[Burp Suite/Proxy|Proxy]] > `HTTP history`
2. Identify a request to investigate
3. Right-click the request and select `Do active scan`
4. Review the `Issues` list on the `Dashboard`
   to identify any directory traversal issues

___
<!-- }}} -->
