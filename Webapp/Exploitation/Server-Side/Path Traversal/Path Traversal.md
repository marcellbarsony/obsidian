---
id: Path Traversal
aliases: []
tags:
  - Webapp/Exploitation/Server-Side/Path-Traversal
---

# Path Traversal

**Path Traversal Attack**
(*[Directory Traversal Attack](https://en.wikipedia.org/wiki/Directory_traversal_attack)*)
of user-supplied file names
— such that characters representing "traverse to parent directory" (`../`) —
are passed through to the operating system's file system API.

**Path Traversal** vulnerabilities enable an attacker
to read arbitrary files (*outside the [[Web Server Root]]*)
on the server that is running an application:

- Application code and data
- Credentials for back-end systems
- Sensitive operating system files

___

<!-- Enumeration {{{-->
## Enumeration

The web application loads an image using the following HTML

```html
<img src="/loadImage?filename=75.png">
```

> [!example]- Example - Source Code
>
> ![[source-code.png]]

The `loadImage` URL takes a `filename` parameter
and returns the contents of the specified file:

```sh
/var/www/images/75.png
```

<!-- Vulnerable Endpoints {{{-->
### Vulnerable Endpoints

A directory traversal vulnerability exists
when the server uses user-supplied input to load a file.

This usually happens with

- Images (e.g., avatar)
- Download buttons
- Anything that displays local files

Request examples:

- `?file=`
- `?image=`
- `?filename=`
- `?path=`
- `/download/…`
- `/productimage?…`
- `/avatar?image=…`

<!-- }}} -->

___
<!-- }}} -->

<!-- Exploitation {{{-->
## Exploitation

> [!tip]-
>
> Automate exploitation with [[DotDotPwn]]

1. Capture `GET` requests

2. Check `Proxy` and `Proxy` > `HTTP history` for traversable file paths
   (*`GET` Requests*)

<!-- Example {{{-->
> [!example]- Example - Burp Intercept
>
> Proxy > HTTP history
>
> ![[burp-intercept.png]]
<!-- }}} -->


3. Send the intercepted `GET` request to the Repeater (*`CTRL + R`*)

4. Traverse the file path

```http
GET /image?filename=../../../../../etc/passwd HTTP/2
```

```http
https://insecure-website.com/loadImage?filename=..\..\..\windows\win.ini
```

<!-- Example {{{-->
> [!example]- Example - Burp Repeater
>
> ![[burp-repeater.png]]
<!-- }}} -->

<!-- Windows {{{-->
> [!info]- Windows
>
> On Windows, both `../` and `..\` are valid directory traversal sequences
<!-- }}} -->

___
<!-- }}} -->

<!-- Common Obstacles {{{-->
## Common Obstacles

> [!todo]
>
> [PortSwigger - Common Obstacles](https://portswigger.net/web-security/file-path-traversal#common-obstacles-to-exploiting-path-traversal-vulnerabilities)

___
<!-- }}} -->

<!-- Mitigation {{{-->
## Mitigation

To mitigate such vulnerabilities, developers should never blindly trust
user-supplied inputs that could potentially interact with the file system API,
and must implement robust validation techniques, such as

- input sanitization
- directory whitelisting
- path canonicalization
- or limiting permissions (*least privilege principle*)

___
<!-- }}} -->
