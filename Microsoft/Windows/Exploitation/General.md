---
id: General
aliases: []
tags:
  - Microsoft/Windows/Exploitation/General
links: "[[Windows]]"
---

# Window Exploits

<!-- Info {{{-->
> [!info]- Windows Exploits
>
> Prominent Windows Exploits
>
> - [[SMB/Exploitation#Netapi|Netapi]]:
>   MS08-067 was a critical patch pushed out to many different Windows revisions due to an SMB flaw. This flaw made it extremely easy to infiltrate a Windows host. It was so efficient that the Conficker worm was using it to infect every vulnerable host it came across. Even Stuxnet took advantage of this vulnerability.
>
> - [[SMB/Exploitation#EternalBlue|EternalBlue]] (*MS17-010*)
>   is an exploit leaked in the Shadow Brokers dump from the NSA.
>   This exploit was most notably used in the WannaCry ransomware and NotPetya cyber attacks. This attack took advantage of a flaw in the SMB v1 protocol allowing for code execution. EternalBlue is believed to have infected upwards of 200,000 hosts just in 2017 and is still a common way to find access into a vulnerable Windows host.
>
> - **PrintNightmare**:
>   A remote code execution vulnerability in the Windows Print Spooler. With valid credentials for that host or a low privilege shell, you can install a printer, add a driver that runs for you, and grants you system-level access to the host. This vulnerability has been ravaging companies through 2021. 0xdf wrote an awesome post on it here.
>
> - [[RDP/Exploitation#BlueKeep|BlueKeep]] (*CVE 2019-0708*)
>   is a vulnerability in Microsoft's RDP protocol that allows for Remote Code Execution. This vulnerability took advantage of a miss-called channel to gain code execution, affecting every Windows revision from Windows 2000 to Server 2008 R2.
>
> - **Sigred** (*CVE 2020-1350*)
>   utilized a flaw in how DNS reads SIG resource records. It is a bit more complicated than the other exploits on this list, but if done correctly, it will give the attacker Domain Admin privileges since it will affect the domain's DNS server which is commonly the primary Domain Controller.
>
> - **SeriousSam** (*CVE 2021-36934*)
>   exploits an issue with the way Windows handles permission on the C:\Windows\system32\config folder. Before fixing the issue, non-elevated users have access to the SAM database, among other files. This is not a huge issue since the files can't be accessed while in use by the pc, but this gets dangerous when looking at volume shadow copy backups. These same privilege mistakes exist on the backup files as well, allowing an attacker to read the SAM database, dumping credentials.
>
> - **Zerologon** (*CVE 2020-1472*)
>   is a critical vulnerability that exploits a cryptographic flaw in Microsoftâ€™s Active Directory Netlogon Remote Protocol (MS-NRPC). It allows users to log on to servers using NT LAN Manager (NTLM) and even send account changes via the protocol. The attack can be a bit complex, but it is trivial to execute since an attacker would have to make around 256 guesses at a computer account password before finding what they need. This can happen in a matter of a few seconds.
>
<!-- }}} -->

<!-- Info {{{-->
> [!info]- Payload Types
>
> Windows Payload Types
>
> - [DLLs](https://learn.microsoft.com/en-us/troubleshoot/windows-client/setup-upgrade-and-drivers/dynamic-link-library)
>   A Dynamic Linking Library (DLL) is a library file
>   used in Microsoft operating systems to provide shared code and data
>   that can be used by many different programs at once.
>   These files are modular and allow us to have applications
>   that are more dynamic and easier to update.
>   As a pentester, injecting a malicious DLL
>   or hijacking a vulnerable library on the host
>   can elevate our privileges to `SYSTEM`
>   and/or bypass User Account Controls.
> - [Batch](https://commandwindows.com/batch.htm)
>   files are text-based DOS scripts utilized by system administrators
>   to complete multiple tasks through the command-line interpreter.
>   These files end with an extension of `.bat`.
>   We can use batch files to run commands on the host in an automated fashion.
>   For example, we can have a batch file open a port on the host,
>   or connect back to our attacking box.
>   Once that is done, it can then perform basic enumeration steps
>   and feed us info back over the open port.
> - [VBS VBScript](https://www.guru99.com/introduction-to-vbscript.html)
>   is a lightweight scripting language based on Microsoft's Visual Basic.
>   It is typically used as a client-side scripting language in webservers
>   to enable dynamic web pages.
>   VBS is dated and disabled by most modern web browsers
>   but lives on in the context of Phishing
>   and other attacks aimed at having users perform an action
>   such as enabling the loading of Macros in an excel document
>   or clicking on a cell to have the Windows scripting engine
>   execute a piece of code.
> - [MSI](https://learn.microsoft.com/en-us/windows/win32/msi/windows-installer-file-extensions)
>   files serve as an installation database for the Windows Installer.
>   When attempting to install a new application,
>   the installer will look for the `.msi` file
>   to understand all of the components required and how to find them.
>   We can use the Windows Installer by crafting a payload as an `.msi` file.
>   Once we have it on the host, we can run `msiexec` to execute our file,
>    which will provide us with further access, such as an elevated reverse shell.
> - [[Powershell]] is both a shell environment and scripting language.
>   It serves as Microsoft's modern shell environment in their operating systems.
>   As a scripting language, it is a dynamic language
>   based on the .NET Common Language Runtime that,
>   like its shell component, takes input and output as .NET objects.
>   PowerShell can provide us with a plethora of options
>   when it comes to gaining a shell and execution on a host,
>   among many other steps in our penetration testing process.
>
<!-- }}} -->

<!-- Info {{{-->
> [!info]- Payload Sources
>
> Windows Payload Resources
>
> - [[MSFVenom]] & Metasploit-Framework
>   can enumerate hosts, generate payloads,
>   leverage public or custom exploits,
>   and perform post-exploitation actions
>   once access is achieved.
>
> - [Payloads All The Things](https://github.com/swisskyrepo/PayloadsAllTheThings)
>   A large collection of resources and cheat sheets
>   focused on payload generation techniques and general exploitation methodology.
>   Useful for quickly mapping objectives to practical payload choices.
>
> - [Mythic C2 Framework](https://github.com/its-a-feature/Mythic)
>   is an alternative to Metasploit that focuses on Command and Control.
>   It provides a modern C2 framework and tooling for generating
>   unique and customizable payloads for red team operations.
>
> - [Nishang](https://github.com/samratashok/nishang)
>   is a collection of offensive PowerShell scripts and implants.
>   It contains utilities for execution, persistence, privilege escalation,
>   and post-exploitation tasks on Windows environments.
>
> - [Darkarmour](https://github.com/bats3c/darkarmour)
>   is a tool designed to generate obfuscated binaries
>   for Windows targets.
>   It is primarily used to evade static detection mechanisms
>   and assist in payload delivery during engagements.
>
<!-- }}} -->

___
