---
id: Exploitation
aliases: []
tags:
  - Networking/Services/SMB/Exploitation
links: "[[SMB]]"
---

# Exploitation

## Port 445

### IPC$ Share

Access to the `IPC$` share can be obtained through an anonymous null session.

[[Enumeration#Enum4Linux-ng|Enum4Linux-ng]] can be utilized to interact with the
exposed services via named pipes.

### Brute Force

#### SMB Login

Brute force SMB login with Nmap

```sh
nmap --script smb-brute -p 445 <ip>
```

Brute force SMB login with Hydra

```sh
hydra -l {target_user} -P {password_list} {target_ip} smb -t 1
```

### EternalBlue

Some SMB versions may be vulnerable to RCE exploits such as
[EternalBlue](https://www.avast.com/c-eternalblue)

Metasploit has several [modules](https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue/)
for EternalBlue that can be used to validate and exploit the vulnerability.

```sh
nmap -A -p445 <target_ip>
```

### Metasploit

Search for exploits with Metasploit

```sh
msf> search type:exploit platform:windows target:2008 smb
searchsploit microsoft smb
```

### Common Credentials

> [!example]-
>
> | Username             | Password                                |
> | -------------------- | --------------------------------------- |
> | (blank)              | (blank)                                 |
> | guest                | (blank)                                 |
> | Administrator, admin | (blank), password, administrator, admin |
> | arcserve             | arcserve, backup                        |
> | tivoli, tmersrvd     | tivoli, tmersrvd, admin                 |
> | backupexec, backup   | backupexec, backup, arcada              |
> | test, lab, demo      | password, test, lab, demo               |
