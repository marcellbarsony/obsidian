---
id: Exploitation
aliases: []
tags:
  - Networking/Services/FTP/Exploitation
links: "[[FTP]]"
---

# Exploitation

<!-- Checklist {{{-->
## Checklist

- [ ] [[Usage#Connection|Connect & Log in]]
    - [ ] [[#Anonymous Login|Anonymous Login]]
    - [ ] [[#Common Credentials|Common Credentials]]
    - [ ] Try already discovered credentials
    - [ ] [[#Brute Force|Brute force]]
- [ ] [[#FTP Bounce Attack|FTP Bounce Attack]]
    - [ ] [[#Bounce Scan|Bounce Scan]]
        - [ ] [[#Nmap|Nmap]]
        - [ ] [[#Metasploit|Metasploit]]

<!-- }}} -->

<!-- FTP Log In {{{-->
## FTP Log In

<!-- Anonymous Login {{{-->
### Anonymous Login

Anonymous login

```sh
ftp <ip>
>anonymous # Username
>anonymous # Password
>binary # Set transmission to binary
>ascii # Set transmission to ASCII
>bye # Exit
```

<!-- Example {{{-->
> [!example]-
> Anonymous Login example
>
> ```sh
> ftp -p 10.129.42.253
> ```
>
> ```sh
> Connected to 10.129.42.253.
> 220 (vsFTPd 3.0.3)
> Name (10.129.42.253:user): anonymous
> 230 Login successful.
> Remote system type is UNIX.
> Using binary mode to transfer files.
> ```
<!-- }}} -->

<!-- }}} -->

<!-- Common Credentials {{{-->
### Common Credentials

FTP default credential examples

```
anonymous:anonymous
_anonymous:
_ftp:ftp
admin:admin
root:root
ftpuser:ftpuser
test:test
```

<!-- FTP Default Password List {{{-->
> [!info]-
> FTP Default Password List
>
> [GitHub - SecLists - ftp-betterdefaultpasslist.txt](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt)
> ```sh
> anonymous:anonymous
> test:test
> root:root
> administrator:administrator
> ftpuser:ftpuser
> root:rootpasswd
> root:12hrs37
> ftp:b1uRR3
> admin:admin
> localadmin:localadmin
> admin:1234
> apc:apc
> admin:nas
> Root:wago
> Admin:wago
> User:user
> Guest:guest
> ftp:ftp
> admin:password
> a:avery
> admin:123456
> adtec:none
> admin:admin12345
> none:dpstelecom
> instrument:instrument
> user:password
> root:password
> default:default
> admin:default
> nmt:1234
> admin:Janitza
> supervisor:supervisor
> user1:pass1
> avery:avery
> IEIeMerge:eMerge
> ADMIN:12345
> beijer:beijer
> Admin:admin
> admin:1234
> admin:1111
> root:admin
> se:1234
> admin:stingray
> device:apc
> apc:apc
> dm:ftp
> dmftp:ftp
> httpadmin:fhttpadmin
> user:system
> MELSEC:MELSEC
> QNUDECPU:QNUDECPU
> ftp_boot:ftp_boot
> uploader:ZYPCOM
> ftpuser:password
> USER:USER
> qbf77101:hexakisoctahedron
> ntpupdate:ntpupdate
> sysdiag:factorycast@schneider
> wsupgrade:wsupgrade
> pcfactory:pcfactory
> loader:fwdownload
> test:testingpw
> webserver:webpages
> fdrusers:sresurdf
> nic2212:poiuypoiuy
> user:user00
> su:ko2003wa
> MayGion:maygion.com
> admin:9999
> PlcmSpIp:PlcmSpIp
> ```
<!-- }}} -->

<!-- }}} -->

<!-- Brute Force {{{-->
### Brute Force

Brute Force FTP login with Hydra

> [!example]-
>
> ```sh
> hydra -l <target_user> -P <password_list> <target_ip> ftp
> ```
>
> ```sh
> hydra -L <users_list> -p <password> ftp://<target_ip>
> ```

> [!tip]
>
> Try [[Exploitation#Common Credentials|FTP Common Credentials]] and other
> [password lists](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt)

<!-- }}} -->

<!-- }}} -->

<!-- FTP Bounce Attack {{{-->
## FTP Bounce Attack

**FTP Bounce Attack** exploits the FTP protocol's ability to redirect traffic,
masking the attack source.

Use the FTP server's `PORT` command to route data to another FTP server
at a specified port, making the attack seem to originate from that server.

1. [[Enumeration#Nmap|Find]] an FTP server that allows the `PORT` command

2. [[Usage#Connection|Connect]] to the server

3. Redirect data to the target

```sh
quote PORT <target_ip>,<target_port>
```

4. Initiate a file transfer or command to the target

```sh
get filename
```

### Bounce Scan

<!-- Nmap {{{-->
#### Nmap

[Nmapcan scan networks](https://nmap.org/book/scan-methods-ftp-bounce-scan.html)
via FTP Bounce by specifying the `-b` option

```sh
nmap -b <ftp_server_ip>:<port> <target_network>
```

<!-- }}} -->

<!-- Metasploit {{{-->
#### Metasploit

The [[Metasploit]] `auxiliary/scanner/ftp/ftp_bounce` module scans through
the vulnerable FTP server to find open ports on other systems

<!-- Example {{{-->
> [!example]-
>
> ```sh
> use auxiliary/scanner/ftp/ftp_bounce
> ```
> ```sh
> set RHOSTS <FTP_server>
> ```
> ```sh
> set RPORT <FTP_port>
> ```
> ```sh
> run
> ```
<!-- }}} -->

<!-- }}} -->

<!-- Other Protocols {{{-->
### Other Protocols

This behavior can be abused to make an FTP server interact with other protocols.

A file (containing a HTTP request) can be uploaded to the FTP server
and sent to an arbitrary HTTP server:

1. **Upload the request** (in a *txt* file) to the server.
   To talk with another HTTP or FTP server

> [!info]
>
> The line endings need to be changed to `0x0d` `0x0a`

2. **Use** `REST X` **to avoid sending unwanted characters**

3. **Use** `PORT` **to connect to the arbitrary server and service**

4. **Use** `RETR` **to send the saved request** to the server

<!-- Warning {{{-->
> [!warning]
>
> It's highly possible that this will throw an error
> (e.g. *Socket not writeable*)
> as the connection doesn't last long enough to send the data
> with `RETR`.
>
> > [!tip]
> >
> > To avoid this:
> >
> > - **Put the same request on after another**
> >  ([like this](https://book.hacktricks.wiki/en/files/posts.txt))
> >  until ~0.5MB, if sending the same HTTP request
> > - **Fill the request with "junk" data** relative to the protocol
> > - **Fill the request with a lot of null characters**
<!-- }}} -->

<!-- }}} -->

<!-- }}} -->

<!-- FileZilla Server Vulnerability {{{-->
## FileZilla Server Vulnerability

**[FileZilla](https://filezilla-project.org/) Server** usually binds to the
local administrative TCP port `14147`. If it is possible to create a tunnel
from the attacker machine to this port:

- Authenticate using a blank password
- Create a new user for the FTP service
<!-- }}} -->
