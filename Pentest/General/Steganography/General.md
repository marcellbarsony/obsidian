---
id: Steganography
aliases: []
tags:
  - Pentest/File/Steganography/General
---

# Steganography

[Steganography](https://en.wikipedia.org/wiki/Steganography)
is the practice of representing information within another message
or physical object, in such a manner that the presence
of the concealed information would not be evident
to an unsuspecting person's examination

<!-- Info {{{-->
> [!info]- Resources
>
> - [HackTricks](https://book.hacktricks.wiki/en/stego/index.html)
> - [0xrick](https://0xrick.github.io/lists/stego/)
>
<!-- }}} -->

___

<!-- Enumeration {{{-->
## Enumeration

Approach steganography as a forensics problem:
1. Identify the real container, enumerate high-signal locations
   (*metadata, appended data, embedded files*),
2. Only then apply content-level extraction techniques

<!-- Container {{{-->
### Container

Identify the real container format of the file

[file](https://en.wikipedia.org/wiki/File_(command)) —
Run heuristics to determine file type and container

```sh
file <file>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> file unknown-file
> ```
<!-- }}} -->

If file and the extension disagree, trust `file`.

Treat common formats as containers when appropriate
(*e.g., OOXML documents are ZIP files*)

<!-- }}} -->

<!-- Metadata {{{-->
### Metadata

Look for metadata and obvious printable strings

[[exiftool]]

```sh
exiftool <file>
```

[strings](https://linux.die.net/man/1/strings)

```sh
strings <file>
```

```sh
strings -n 6 <file> | head
```

```h
strings -n 6 <file> | tail
```

Try multiple encodings

```sh
strings -e l -n 6 <file> | head
```
```sh
strings -e b -n 6 <file> | head
```

<!-- }}} -->

<!-- Appended Data {{{-->
### Appended Data

Enumerate file for appended data & embedded files

[[Binwalk]]

```sh
binwalk <file>
```

```sh
binwalk -e <file>
```

If extraction fails but signatures are reported,
manually carve offsets with dd and re-run file on the carved region

```sh
binwalk -dd '.*' <file>
```

<!-- }}} -->

<!-- Zip-in-Disguise {{{-->
### Zip-in-Disguise

Try [7z](https://www.7-zip.org/) and [unzip](https://linux.die.net/man/1/unzip)
even if the extension is not an archive

```sh
7z l <file>
```
```sh
unzip -l <file>
```

<!-- }}} -->

___
<!-- }}} -->

<!-- Operations {{{-->
## Operations

[[steghide]] — Embed and Extract data

[[steghide#embed|Embed Data]]

```sh
steghide --embed [options] <file>
```

[[steghide#Extract|Extract Data]]

```sh
steghide --extract [options] <file>
```

<!-- Recovery {{{-->
### Recovery

[[Foremost]]

Basic file recovery

```sh
foremost <disk.img>
```

<!-- }}} -->

___
<!-- }}} -->
