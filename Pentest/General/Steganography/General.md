---
id: Steganography
aliases: []
tags:
  - Pentest/File/Steganography/General
---

# Steganography

[Steganography](https://en.wikipedia.org/wiki/Steganography)
is the practice of representing information within another message
or physical object, in such a manner that the presence
of the concealed information would not be evident
to an unsuspecting person's examination

<!-- Info {{{-->
> [!info]- Resources
>
> - [HackTricks](https://book.hacktricks.wiki/en/stego/index.html)
> - [0xrick](https://0xrick.github.io/lists/stego/)
>
<!-- }}} -->

___

<!-- Enumeration {{{-->
## Enumeration

Approach steganography as a forensics problem:
1. Identify the real container, enumerate high-signal locations
   (*metadata, appended data, embedded files*),
2. Only then apply content-level extraction techniques

<!-- Container {{{-->
### Container

Identify the real container format of the file

[file](https://en.wikipedia.org/wiki/File_(command)) â€”
Run heuristics to determine file type and container

```sh
file <file>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> file unknown-file
> ```
<!-- }}} -->

If file and the extension disagree, trust `file`.

Treat common formats as containers when appropriate
(*e.g., OOXML documents are ZIP files*)

<!-- }}} -->

<!-- Metadata {{{-->
### Metadata

Look for metadata and obvious printable strings

[[exiftool]]

```sh
exiftool <file>
```

[strings](https://linux.die.net/man/1/strings)

```sh
strings <file>
```

```sh
strings -n 6 <file> | head
```

```h
strings -n 6 <file> | tail
```

Try multiple encodings

```sh
strings -e l -n 6 <file> | head
```
```sh
strings -e b -n 6 <file> | head
```

<!-- }}} -->

<!-- Appended Data {{{-->
### Appended Data

Enumerate file for appended data & embedded files

[[Binwalk]]

```sh
binwalk <file>
```

```sh
binwalk -e <file>
```

If extraction fails but signatures are reported,
manually carve offsets with dd and re-run file on the carved region

```sh
binwalk -dd '.*' <file>
```

<!-- }}} -->

<!-- Zip-in-Disguise {{{-->
### Zip-in-Disguise

Try [7z](https://www.7-zip.org/) and [unzip](https://linux.die.net/man/1/unzip)
even if the extension is not an archive

```sh
7z l <file>
```
```sh
unzip -l <file>
```

<!-- }}} -->

___
<!-- }}} -->

<!-- Tools {{{-->
## Tools

[steghide](https://www.kali.org/tools/steghide/)
is steganography program which hides bits of a data file
in some of the least significant bits of another file
in such a way that the existence of the data file
is not visible and cannot be proven.

Steghide is designed to be portable and configurable and features
hiding data in bmp, jpeg, wav and au files, blowfish encryption,
MD5 hashing of passphrases to blowfish keys,
and pseudo-random distribution of hidden bits in the container data.

Steghide is useful in digital forensics investigations.

```sh
sudo apt install steghide
```

___
<!-- }}} -->
