---
id: Document
aliases: []
tags:
  - Pentest/File/Steganography/Document
---

# Document

**Portable Document Format**
(*[PDF](https://en.wikipedia.org/wiki/PDF)*)
is a structured container with objects, streams,
and optional embedded files

<!-- Tip {{{-->
> [!tip]-
>
> - Extract embedded attachments
> - Decompress/flatten object streams so you can search content
> - Identify hidden objects (JS, embedded images, odd streams)
>
<!-- }}} -->

___

<!-- Enumeration {{{-->
## Enumeration

Documents are often just containers:

- PDF (*embedded files, streams*)
- Office OOXML (*`.docx`/`.xlsx`/`.pptx` are ZIPs*)
- RTF / OLE legacy formats

PDF is a structured container with objects,
streams, and optional embedded files

- Extract embedded attachments
- Decompress/flatten object streams so you can search content
- Identify hidden objects (*JS, embedded images, odd streams*)

[[ExifTool]]

```sh
exiftool <file.pdf>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> exiftool 4nx3z5afbff9juzve28q1vp7wzodd7cw.pdf
> ```
> ```sh
> ExifTool Version Number         : 13.36
> File Name                       : 4nx3z5afbff9juzve28q1vp7wzodd7cw.pdf
> Directory                       : .
> File Size                       : 4.6 kB
> File Modification Date/Time     : 2026:01:18 21:21:08-05:00
> File Access Date/Time           : 2026:01:18 21:21:08-05:00
> File Inode Change Date/Time     : 2026:01:18 21:21:37-05:00
> File Permissions                : -rw-rw-r--
> File Type                       : PDF
> File Type Extension             : pdf
> MIME Type                       : application/pdf
> PDF Version                     : 1.4
> Linearized                      : No
> Page Count                      : 1
> Creator                         : Generated by pdfkit v0.8.6
> ```
<!-- }}} -->


[pdfid](https://www.kali.org/tools/pdfid/)

```sh
pdfid <file>
```

[[Poppler-Utils#pdfinfo|pdfinfo]]

```sh
pdfinfo <file.pdf>
```

[[Poppler-Utils#pdfdetach|pdfdetach]]

```sh
pdfdetach -list <file.pdf>
```

```sh
pdfdetach -saveall <file.pdf>
```

[[qpdf]]

```sh
qpdf --qdf --object-streams=disable <file.pdf> <out.pdf>
```

Search `out.pdf` for suspicious objects/strings

<!-- Office OOXML {{{-->
### Office OOXML

Treat [OOXML](https://en.wikipedia.org/wiki/Office_Open_XML)
as a ZIP + XML relationship graph;
payloads often hide in media, relationships, or odd custom parts

OOXML files are ZIP containers:

- The document is a directory tree of XML and assets.
- The _rels/ relationship files can point to external resources or hidden parts.
- Embedded data frequently lives in word/media/, custom XML parts, or unusual relationships.

```sh
7z l <file.docx>
```
```sh
7z x <file.docx> -oout
```

Then inspect

- `word/document.xml`
- `word/_rels/` for external relationships
- `word/media/` for embedded media


<!-- }}} -->

___
<!-- }}} -->
