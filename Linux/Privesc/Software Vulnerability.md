---
id: Software Vulnerability
aliases: []
tags:
  - Linux/Privesc/Vulnerable-Software
links: "[[Privesc]]"
---

# Software Vulnerability

Check what software is installed on the target host

___

<!-- Installed Software {{{-->
## Installed Software

<!-- Tip {{{-->
> [!tip]
>
> [[#GTFOBins]]:
> Look for public exploits of any installed software,
> especially if older, unpatched versions are in use
>
> Enumerate installed programming languages
>
<!-- }}} -->

<!-- Linux {{{-->
### Linux

Enumerate useful binaries

<!-- Example {{{-->
> [!example]-
>
> ```sh
> which nmap aws nc ncat netcat nc.traditional wget curl ping gcc g++ make gdb base64 socat python python2 python3 python2.7 python2.6 python3.6 python3.7 perl php ruby xterm doas sudo fetch docker lxc ctr runc rkt kubectl 2>/dev/null
> ```
<!-- }}} -->

Arch

```sh
pacman -Q > pkgs-list.txt
```

Binaries

```sh
ls /bin /usr/bin/ /usr/sbin/ > /tmp/pkgs-bin.txt
```

Debian

```sh
apt list --installed
```

```sh
apt list --installed 2>/dev/null | cut -d/ -f1 > /tmp/pkgs-list.txt
```

Ubuntu

```sh
dpkg --get-selections > pkgs.txt
```

Fedora / RHEL / CentOS

```sh
rpm -qa > pkgs.txt
```

```sh
dnf list installed > pkgs.txt
```

<!-- }}} -->

<!-- BSD {{{-->
### BSD

FreeBSD

```sh
pkg info
```

OpenBSD

```sh
pkg_info
```

NetBSD

```sh
pkgin list
```
<!-- }}} -->

<!-- macOS {{{-->
### macOS

[Homebrew](https://en.wikipedia.org/wiki/Homebrew_(package_manager))

```sh
brew list
```

[MacPorts](https://en.wikipedia.org/wiki/MacPorts)

```sh
port installed
```
<!-- }}} -->

___
<!-- }}} -->

<!-- GTFOBins {{{-->
## GTFOBins

[GTFOBins](https://gtfobins.github.io/) —
Compare installed binaries (*`pkgs.txt`*)

<!-- Merge & Sanitize {{{-->
> [!tip]- Merge & Sanitize
>
> Merge and sanitize packages from the package manager
> and directly installed binaries
>
> ```sh
> cat /tmp/pkgs-list.txt /tmp/pkgs-bin.txt | \
>   grep -v '^$' | \
>   sort -u > pkgs.txt
> ```
<!-- }}} -->

```sh
for i in $(curl -s https://gtfobins.github.io/ | html2text | cut -d" " -f1 | sed '/^[[:space:]]*$/d'); do \
    if grep -q "$i" pkgs.txt; \
    then echo "[+] :: $i\t:: https://gtfobins.github.io/gtfobins/$i"; \
    fi; \
done
```

___
<!-- }}} -->

<!-- Strace {{{-->
## Strace

[strace](https://linux.die.net/man/1/strace) —
Trace system calls and signals

<!-- Info {{{-->
> [!info]-
>
> Follow the flow of a program
> and understand how it accesses system resources,
> processes signals, and receives and sends data
> from the operating system
<!-- }}} -->

```sh
strace <command [ args ]>
```

<!-- Example {{{-->
> [!example]-
>
> ```sh
> strace ping -c1 10.129.112.20
> ```
>
> ```sh
> execve("/usr/bin/ping", ["ping", "-c1", "10.129.112.20"], 0x7ffdc8b96cc0 /* 80 vars */) = 0
> access("/etc/suid-debug", F_OK)         = -1 ENOENT (No such file or directory)
> brk(NULL)                               = 0x56222584c000
> arch_prctl(0x3001 /* ARCH_??? */, 0x7fffb0b2ea00) = -1 EINVAL (Invalid argument)
> ...SNIP...
> access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
> ...SNIP...
> openat(AT_FDCWD, "/lib/x86_64-linux-gnu/libidn2.so.0", O_RDONLY|O_CLOEXEC) = 3
> ...SNIP...
> read(3, "\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0P\237\2\0\0\0\0\0"..., 832) = 832
> pread64(3, "\6\0\0\0\4\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0@\0\0\0\0\0\0\0"..., 784, 64) = 784
> pread64(3, "\4\0\0\0 \0\0\0\5\0\0\0GNU\0\2\0\0\300\4\0\0\0\3\0\0\0\0\0\0\0"..., 48, 848) = 48
> ...SNIP...
> socket(AF_INET, SOCK_DGRAM, IPPROTO_ICMP) = 3
> socket(AF_INET6, SOCK_DGRAM, IPPROTO_ICMPV6) = 4
> capget({version=_LINUX_CAPABILITY_VERSION_3, pid=0}, NULL) = 0
> capget({version=_LINUX_CAPABILITY_VERSION_3, pid=0}, {effective=0, permitted=0, inheritable=0}) = 0
> openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache", O_RDONLY) = 5
> ...SNIP...
> socket(AF_INET, SOCK_DGRAM, IPPROTO_IP) = 5
> connect(5, {sa_family=AF_INET, sin_port=htons(1025), sin_addr=inet_addr("10.129.112.20")}, 16) = 0
> getsockname(5, {sa_family=AF_INET, sin_port=htons(39885), sin_addr=inet_addr("10.129.112.20")}, [16]) = 0
> close(5)                                = 0
> ...SNIP...
> sendto(3, "\10\0\31\303\0\0\0\1eX\327c\0\0\0\0\330\254\n\0\0\0\0\0\20\21\22\23\24\25\26\27"..., 64, 0, {sa_family=AF_INET, sin_port=htons(0), sin_addr=inet_addr("10.129.112.20")}, 16) = 64
> ...SNIP...
> recvmsg(3, {msg_name={sa_family=AF_INET, sin_port=htons(0), sin_addr=inet_addr("10.129.112.20")}, msg_namelen=128 => 16, msg_iov=[{iov_base="\0\0!\300\0\3\0\1eX\327c\0\0\0\0\330\254\n\0\0\0\0\0\20\21\22\23\24\25\26\27"..., iov_len=192}], msg_iovlen=1, msg_control=[{cmsg_len=32, cmsg_level=SOL_SOCKET, cmsg_type=SO_TIMESTAMP_OLD, cmsg_data={tv_sec=1675057253, tv_usec=699895}}, {cmsg_len=20, cmsg_level=SOL_IP, cmsg_type=IP_TTL, cmsg_data=[64]}], msg_controllen=56, msg_flags=0}, 0) = 64
> write(1, "64 bytes from 10.129.112.20: icmp_se"..., 57) = 57
> write(1, "\n", 1)                       = 1
> write(1, "--- 10.129.112.20 ping statistics --"..., 34) = 34
> write(1, "1 packets transmitted, 1 receive"..., 60) = 60
> write(1, "rtt min/avg/max/mdev = 0.287/0.2"..., 50) = 50
> close(1)                                = 0
> close(2)                                = 0
> exit_group(0)                           = ?
> +++ exited with 0 +++
> ```
<!-- }}} -->

___
<!-- }}} -->

<!-- Security Software {{{-->
## Security Software

Enumerate security software for vulnerabilities and defense capabilities

<!-- Common Security Software {{{-->
> [!example] Common Security Software
>
> - [[AppArmor]]
> - [[Exec Shield]]
> - [[Fail2ban]]
> - [[iptables]]
> - [[SELinux]]
> - [[Snort]]
<!-- }}} -->

AppArmor

```sh
if [ `which aa-status 2>/dev/null` ]; then
    aa-status
  elif [ `which apparmor_status 2>/dev/null` ]; then
    apparmor_status
  elif [ `ls -d /etc/apparmor* 2>/dev/null` ]; then
    ls -d /etc/apparmor*
  else
    echo ":: [-] :: AppArmor not found"
fi
```

ASLR (*If `0`, not enabled*)

```sh
cat /proc/sys/kernel/randomize_va_space 2>/dev/null
```

Execshield

```sh
(grep "exec-shield" /etc/sysctl.conf || echo ":: [-] Execshield not found")
```

Grsecurity

```sh
((uname -r | grep "\-grsec" >/dev/null 2>&1 || grep "grsecurity" /etc/sysctl.conf >/dev/null 2>&1) && echo "Yes" || echo ":: [-] :: Grsecurity not found")
```

PaX

```sh
(which paxctl-ng paxctl >/dev/null 2>&1 && echo "Yes" || echo ":: [-] :: PaX not found")
```

SElinux

```sh
(sestatus 2>/dev/null || echo ":: [-] :: setatus not found")
```

___
<!-- }}} -->
